<!doctype html>
<html lang=pl>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>PoKreGaM</title>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css>
<script type=module>import{initializeApp}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";import{getAuth,signInAnonymously,signInWithCustomToken,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";import{getFirestore,doc,getDoc,setDoc,collection,query,onSnapshot,addDoc,deleteDoc}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";const firebaseConfig="undefined"!=typeof __firebase_config?JSON.parse(__firebase_config):{},appId="undefined"!=typeof __app_id?__app_id:"default-app-id";let app,db,auth,currentUserId=null,currentUserData={};async function initializeFirebaseAndAuth(){try{app=initializeApp(firebaseConfig),db=getFirestore(app),auth=getAuth(app),window.firebaseApp=app,window.firestoreDb=db,window.firebaseAuth=auth,"undefined"!=typeof __initial_auth_token&&__initial_auth_token?(await signInWithCustomToken(auth,__initial_auth_token),console.log("Signed in with custom token.")):(await signInAnonymously(auth),console.log("Signed in anonymously.")),onAuthStateChanged(auth,(async e=>{if(e){currentUserId=e.uid,console.log("Auth state changed. User ID:",currentUserId);const t=await window.loadUserDataFromFirestore();t&&(window.updateProfileUI&&window.updateProfileUI(t),window.loadAllPosts&&window.loadAllPosts(),window.loadFriendsList&&window.loadFriendsList())}else currentUserId=null,console.log("User logged out or not authenticated."),window.showSection&&window.showSection(document.getElementById("loginSection")),window.clearProfileUI&&window.clearProfileUI()}))}catch(e){console.error("Error initializing Firebase or signing in:",e);const t=document.getElementById("loginError");t&&(t.textContent="Error connecting to service. Please try again later."),window.showSection&&window.showSection(document.getElementById("loginSection"))}}window.firebaseApp=null,window.firestoreDb=null,window.firebaseAuth=null,window.getCurrentUserId=()=>currentUserId,window.saveUserDataToFirestore=async e=>{if(!currentUserId||!db)return void console.warn("User not authenticated or Firestore not initialized. Cannot save data.");const t=doc(db,`artifacts/${appId}/users/${currentUserId}/profile/data`);try{await setDoc(t,e,{merge:!0}),console.log("User data saved successfully to Firestore!"),currentUserData={...currentUserData,...e}}catch(e){console.error("Error saving user data to Firestore: ",e)}},window.loadUserDataFromFirestore=async()=>{if(!currentUserId||!db)return console.warn("User not authenticated or Firestore not initialized. Cannot load data."),null;const e=doc(db,`artifacts/${appId}/users/${currentUserId}/profile/data`);try{const t=await getDoc(e);if(t.exists()){const e=t.data();return console.log("User data loaded from Firestore:",e),currentUserData=e,e}{console.log("No user data found for this user. Initializing default.");const e={xp:0,level:1,friends:[],gold:0,avatar:"https://placehold.co/80x80/cccccc/000000?text=👤"};return await window.saveUserDataToFirestore(e),currentUserData=e,e}}catch(e){return console.error("Error loading user data from Firestore: ",e),null}},window.addPostToFirestore=async e=>{if(!currentUserId||!db)return console.warn("User not authenticated or Firestore not initialized. Cannot add post."),!1;const t=collection(db,`artifacts/${appId}/public/posts`);try{return await addDoc(t,{...e,userId:currentUserId,timestamp:new Date}),console.log("Post added successfully to Firestore!"),!0}catch(e){return console.error("Error adding post to Firestore: ",e),!1}},window.getPostsFromFirestore=e=>{if(!db)return console.warn("Firestore not initialized. Cannot get posts."),()=>{};const t=collection(db,`artifacts/${appId}/public/posts`),o=query(t),r=onSnapshot(o,(t=>{const o=t.docs.map((e=>({id:e.id,...e.data()})));o.sort(((e,t)=>(t.timestamp?.toDate()||0)-(e.timestamp?.toDate()||0))),e(o)}),(e=>{console.error("Error getting posts from Firestore: ",e)}));return r},window.addEventListener("load",initializeFirebaseAndAuth)</script>
<style>body{font-family:Inter,sans-serif;margin:0;padding:0;background-color:#f7fafc;color:#2d3748;display:flex;flex-direction:column;min-height:100vh}header{background-color:#2d3748;color:#fff;padding:10px 20px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 4px 12px rgba(0,0,0,.2);flex-wrap:wrap;border-bottom-left-radius:12px;border-bottom-right-radius:12px;position:sticky;top:0;z-index:100}header h1{margin:0;font-size:2em;color:#63b3ed;font-weight:800}.header-controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}.header-controls button,.header-controls select{padding:10px 18px;border:none;border-radius:8px;cursor:pointer;background-color:#4a5568;color:#fff;font-weight:600;transition:background-color .3s ease-in-out,transform .1s ease-in-out;white-space:nowrap;box-shadow:0 2px 5px rgba(0,0,0,.1)}.header-controls button:hover,.header-controls select:hover{background-color:#2c3748;transform:translateY(-1px)}main{flex-grow:1;padding:20px;display:flex;justify-content:center;align-items:flex-start;width:100%;box-sizing:border-box}section{background-color:#fff;padding:30px;border-radius:16px;box-shadow:0 8px 25px rgba(0,0,0,.15);width:100%;max-width:700px;box-sizing:border-box;margin-bottom:30px;transition:opacity .3s ease-in-out,transform .3s ease-in-out}section.hidden{display:none;opacity:0;transform:translateY(20px)}section:not(.hidden){opacity:1;transform:translateY(0)}h2{color:#2d3748;text-align:center;margin-bottom:25px;font-size:2em;font-weight:700}form{display:flex;flex-direction:column;gap:18px}form label{font-weight:700;margin-bottom:5px;display:block;color:#4a5568;font-size:1.1em}form input[type=date],form input[type=email],form input[type=password],form input[type=text],form select,form textarea{width:calc(100% - 24px);padding:12px;border:1px solid #cbd5e0;border-radius:10px;font-size:1.1em;margin-top:5px;box-sizing:border-box;background-color:#edf2f7;color:#2d3748}form button{padding:12px 25px;background-color:#4299e1;color:#fff;border:none;border-radius:10px;cursor:pointer;font-size:1.2em;font-weight:700;transition:background-color .3s ease-in-out,transform .1s ease-in-out,box-shadow .2s;box-shadow:0 4px 10px rgba(0,0,0,.1)}form button:hover{background-color:#3182ce;transform:translateY(-2px);box-shadow:0 6px 15px rgba(0,0,0,.15)}.error-message{color:#e53e3e;margin-top:15px;text-align:center;font-weight:700;font-size:1.1em}.success-message{color:#38a169;margin-top:15px;text-align:center;font-weight:700;font-size:1.1em}.link-text{text-align:center;margin-top:20px}.link-text a,.link-text button{color:#4299e1;text-decoration:none;cursor:pointer;background:0 0;border:none;padding:0;font-size:1.1em;transition:color .2s ease-in-out;font-weight:600}.link-text a:hover,.link-text button:hover{color:#3182ce}#avatarsContainer{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:15px;margin-bottom:25px;justify-items:center}.avatar{border:3px solid transparent;border-radius:12px;padding:8px;cursor:pointer;text-align:center;transition:border-color .3s ease-in-out,background-color .3s ease-in-out,box-shadow .2s;background-color:#edf2f7;box-shadow:0 2px 8px rgba(0,0,0,.05)}.avatar img{width:90px;height:90px;border-radius:50%;object-fit:cover;display:block;margin:0 auto 8px;border:2px solid #cbd5e0}.avatar.selected{border-color:#4299e1;background-color:#ebf8ff;box-shadow:0 0 0 4px rgba(66,153,225,.6);transform:scale(1.05)}#profileSection{display:flex;flex-direction:column;width:100%;max-width:1000px}#profileHeader{display:flex;align-items:center;gap:30px;margin-bottom:25px;padding-bottom:25px;border-bottom:1px solid #e2e8f0;flex-wrap:wrap;justify-content:center;text-align:center}#profileAvatar img{width:120px;height:120px;border-radius:50%;object-fit:cover;border:4px solid #4299e1;box-shadow:0 0 0 6px rgba(66,153,225,.3)}#profileInfo{flex-grow:1}#profileInfo p{margin:8px 0;font-size:1.2em}#profileInfo p strong{color:#4299e1}#profileStats{display:flex;flex-wrap:wrap;gap:20px;margin-top:15px;justify-content:center}#profileStats div{background-color:#ebf8ff;padding:10px 15px;border-radius:8px;font-size:1em;color:#2b6cb0;font-weight:700;box-shadow:0 2px 8px rgba(0,0,0,.08)}#tabs{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:25px;border-bottom:2px solid #e2e8f0;padding-bottom:8px;justify-content:center;background-color:#f7fafc;border-radius:12px 12px 0 0;padding-top:10px}#tabs button{background-color:#edf2f7;color:#555;padding:12px 20px;border:1px solid #cbd5e0;border-bottom:none;border-radius:10px 10px 0 0;cursor:pointer;font-weight:700;transition:background-color .3s ease-in-out,color .3s ease-in-out,border-color .3s ease-in-out;white-space:nowrap;box-shadow:0 2px 5px rgba(0,0,0,.05)}#tabs button.active{background-color:#fff;color:#4299e1;border-color:#4299e1;border-bottom:2px solid #fff;position:relative;z-index:1;box-shadow:0 4px 10px rgba(0,0,0,.1)}.tabContent{background-color:#fff;padding:30px;border-radius:0 0 16px 16px;box-shadow:0 8px 25px rgba(0,0,0,.15)}#rankingTypeButtons{text-align:center;margin-bottom:25px;display:flex;flex-wrap:wrap;justify-content:center;gap:12px}#rankingTypeButtons button{padding:10px 18px;border:1px solid #4299e1;border-radius:8px;background-color:#fff;color:#4299e1;cursor:pointer;font-weight:600;transition:all .3s ease-in-out;box-shadow:0 2px 5px rgba(0,0,0,.05)}#rankingTypeButtons button.active{background-color:#4299e1;color:#fff;box-shadow:0 4px 10px rgba(0,0,0,.1)}#rankingTable{width:100%;border-collapse:collapse;margin-top:20px}#rankingTable td,#rankingTable th{border:1px solid #e2e8f0;padding:12px 15px;text-align:left;word-break:break-word;font-size:1.05em}#rankingTable th{background-color:#f0f4f8;font-weight:700;color:#4a5568;text-transform:uppercase}#rankingTable tbody tr:nth-child(2n){background-color:#edf2f7}#rankingTable tbody tr:hover{background-color:#e0f7fa;transform:scale(1.01);transition:transform .1s ease-in-out}#rankingTable td button.report-user-btn{background-color:#fbd38d;color:#2d3748;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;font-size:.9em;margin-left:12px;transition:background-color .3s ease-in-out,transform .1s ease-in-out;white-space:nowrap;box-shadow:0 2px 5px rgba(0,0,0,.08)}#rankingTable td button.report-user-btn:hover{background-color:#f6ad55;transform:translateY(-1px)}#writePostSection{margin-bottom:30px;padding-bottom:25px;border-bottom:1px solid #e2e8f0}#postContent{resize:vertical;min-height:100px;margin-bottom:15px;padding:12px;border-radius:10px;background-color:#edf2f7;color:#2d3748}#publishPostBtn{width:auto;align-self:flex-end;margin-top:10px;background-color:#48bb78}#publishPostBtn:hover{background-color:#38a169}.post{border:1px solid #e2e8f0;border-radius:12px;padding:20px;margin-bottom:20px;background-color:#fff;box-shadow:0 4px 12px rgba(0,0,0,.08)}.post-header{display:flex;align-items:center;margin-bottom:15px}.post-avatar img{width:50px;height:50px;border-radius:50%;margin-right:15px;object-fit:cover;border:2px solid #cbd5e0}.post-info{flex-grow:1}.post-author{font-weight:700;color:#4299e1;font-size:1.1em}.post-time{font-size:.9em;color:#718096}.post-content{line-height:1.6;white-space:pre-wrap;word-wrap:break-word;color:#4a5568;font-size:1.05em}#allChatsSection{text-align:center}#chatsContent{margin-top:25px;border-top:1px solid #e2e8f0;padding-top:25px;max-height:500px;overflow-y:auto;background-color:#edf2f7;border-radius:12px;padding:15px;box-shadow:inset 0 0 8px rgba(0,0,0,.05)}.chat-container{border:1px solid #cbd5e0;border-radius:10px;padding:18px;margin-bottom:18px;background-color:#fff;box-shadow:0 2px 8px rgba(0,0,0,.08)}.chat-header{font-weight:700;margin-bottom:12px;color:#2b6cb0;border-bottom:1px dashed #bee3f8;padding-bottom:8px;font-size:1.15em}.chat-message{margin-bottom:8px;font-size:1em;color:#4a5568}.chat-message strong{color:#2d3748}.friends-search{display:flex;gap:15px;margin-bottom:25px;flex-wrap:wrap}.friends-search input{flex-grow:1;min-width:150px}.friends-search button{flex-shrink:0;width:auto;padding:12px 25px}.user-list{max-height:350px;overflow-y:auto;border:1px solid #e2e8f0;padding:15px;border-radius:10px;margin-bottom:25px;background-color:#edf2f7}.user-card{display:flex;justify-content:space-between;align-items:center;padding:10px 15px;border-bottom:1px solid #f0f4f8;font-size:1.1em}.user-card:last-child{border-bottom:none}.user-card span{font-weight:700;color:#333}.user-card button{background-color:#48bb78;color:#fff;border:none;padding:8px 15px;border-radius:6px;cursor:pointer;font-size:.95em;transition:background-color .3s ease-in-out;width:auto}.user-card button:hover:not(:disabled){background-color:#38a169}.user-card button:disabled{background-color:#cbd5e0;cursor:not-allowed}.my-friends ul{list-style:none;padding:0}.my-friends li{background-color:#ebf8ff;padding:10px 15px;border-radius:8px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center;color:#2b6cb0;font-weight:700;font-size:1.1em}.my-friends li:last-child{margin-bottom:0}.modal{position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;transition:opacity .3s ease-in-out}.modal.hidden{opacity:0;pointer-events:none}.modal-content{background-color:#fefefe;padding:30px;border:1px solid #a0aec0;border-radius:16px;width:90%;max-width:550px;position:relative;box-shadow:0 12px 30px rgba(0,0,0,.3);animation-name:animatetop;animation-duration:.4s;box-sizing:border-box}@-webkit-keyframes animatetop{from{top:-300px;opacity:0}to{top:0;opacity:1}}@keyframes animatetop{from{top:-300px;opacity:0}to{top:0;opacity:1}}.close-button{color:#718096;font-size:32px;font-weight:700;position:absolute;right:18px;top:15px;cursor:pointer;transition:color .2s ease-in-out}.close-button:focus,.close-button:hover{color:#2d3748;text-decoration:none}.modal-content h2{margin-top:0;margin-bottom:20px;color:#2d3748;font-size:1.8em}.modal-content form label{display:flex;align-items:center;gap:12px;margin-bottom:10px;font-weight:400;font-size:1.05em}.modal-content form input[type=radio]{margin-right:5px;width:auto;transform:scale(1.2)}.modal-content form textarea{width:calc(100% - 24px);min-height:100px;margin-top:15px;padding:12px;border-radius:10px;background-color:#edf2f7;color:#2d3748}.modal-content form button{width:auto;margin-top:20px;align-self:center;padding:12px 30px;background-color:#4299e1}.modal-content form button:hover{background-color:#3182ce}#gameBuilderTab{max-width:1200px;display:flex;flex-direction:column;gap:20px}.builder-controls{display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:20px}.builder-tools{display:flex;flex-direction:column;gap:12px;background-color:#edf2f7;padding:15px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.05);min-width:180px}.builder-tool-item{display:flex;align-items:center;gap:10px;padding:10px;border-radius:8px;cursor:pointer;background-color:#fff;border:1px solid #cbd5e0;transition:background-color .2s,border-color .2s,box-shadow .2s}.builder-tool-item:hover{background-color:#e2e8f0;border-color:#a0aec0}.builder-tool-item.selected{background-color:#bee3f8;border-color:#4299e1;box-shadow:0 0 0 3px rgba(66,153,225,.5)}.builder-tool-item img{width:28px;height:28px}.builder-tool-item span{font-weight:700;color:#2d3748;font-size:1.05em}.color-picker-container{display:flex;flex-wrap:wrap;gap:8px;margin-top:15px;padding-top:10px;border-top:1px solid #e2e8f0}.color-box{width:30px;height:30px;border:2px solid #ccc;cursor:pointer;border-radius:6px;transition:transform .1s,border-color .2s,box-shadow .2s}.color-box.selected{border-color:#4299e1;box-shadow:0 0 0 3px #4299e1;transform:scale(1.15)}#gameCanvasContainer{border:2px solid #a0aec0;border-radius:12px;background-color:#f7fafc;flex-grow:1;display:flex;justify-content:center;align-items:center;overflow:auto;position:relative;min-height:400px;box-shadow:inset 0 0 10px rgba(0,0,0,.1)}#gameCanvas{background-color:#fff;display:block;border-radius:8px;box-shadow:0 0 15px rgba(0,0,0,.1)}.builder-inventory{background-color:#edf2f7;padding:15px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.05);min-width:220px;max-height:500px;overflow-y:auto}.inventory-category{font-weight:700;color:#2d3748;margin-top:15px;margin-bottom:8px;border-bottom:2px solid #cbd5e0;padding-bottom:5px;font-size:1.1em}.inventory-item{display:flex;align-items:center;gap:10px;padding:8px;margin-bottom:8px;border-radius:8px;cursor:pointer;background-color:#fff;border:1px solid #cbd5e0;transition:background-color .2s,border-color .2s,box-shadow .2s}.inventory-item:hover{background-color:#e2e8f0;border-color:#4299e1}.inventory-item.selected{background-color:#bee3f8;border-color:#4299e1;box-shadow:0 0 0 3px rgba(66,153,225,.5)}.inventory-item img{width:24px;height:24px}.inventory-item span{font-size:1em;color:#4a5568}#createNewModelBtn,#selectBlockColorBtn{margin-top:20px;width:100%;background-color:#4299e1;color:#fff;padding:10px 15px;border-radius:8px;cursor:pointer;border:none;font-weight:600;transition:background-color .2s,transform .1s;box-shadow:0 2px 5px rgba(0,0,0,.1)}#createNewModelBtn:hover,#selectBlockColorBtn:hover{background-color:#3182ce;transform:translateY(-1px)}.builder-actions{display:flex;justify-content:flex-end;gap:15px;margin-top:30px;flex-wrap:wrap}.builder-actions button{padding:12px 25px;border-radius:10px;font-weight:700;transition:background-color .3s,transform .1s,box-shadow .2s;box-shadow:0 4px 10px rgba(0,0,0,.1)}#takeScreenshotBtn{background-color:#a0aec0;color:#fff}#takeScreenshotBtn:hover{background-color:#718096}#publishGameBtn{background-color:#48bb78;color:#fff}#publishGameBtn:hover{background-color:#38a169}#backToGamesListBtn{background-color:#e53e3e;color:#fff}#backToGamesListBtn:hover{background-color:#c53030}.game-list-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:25px;margin-top:25px}.game-card{background-color:#f7fafc;border:1px solid #e2e8f0;border-radius:12px;padding:20px;box-shadow:0 4px 15px rgba(0,0,0,.08);display:flex;flex-direction:column;justify-content:space-between;transition:transform .2s ease-in-out,box-shadow .2s}.game-card:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,.12)}.game-card h4{margin-top:0;margin-bottom:12px;color:#2d3748;font-size:1.4em;font-weight:700}.game-card p{font-size:1em;color:#4a5568;margin-bottom:8px}.game-card-actions{display:flex;gap:12px;margin-top:20px}.game-card-actions button{flex:1;padding:10px 15px;border-radius:8px;font-weight:700;transition:background-color .2s,transform .1s;box-shadow:0 2px 5px rgba(0,0,0,.1)}.game-card-actions .build-game-btn{background-color:#63b3ed;color:#fff}.game-card-actions .build-game-btn:hover{background-color:#4299e1;transform:translateY(-1px)}.game-card-actions .play-game-btn{background-color:#48bb78;color:#fff}.game-card-actions .play-game-btn:hover{background-color:#38a169;transform:translateY(-1px)}.game-card-actions .play-game-btn:disabled{background-color:#cbd5e0;cursor:not-allowed;transform:none;box-shadow:none}#playGameSection{text-align:center;max-width:900px}#playGameContent{border:2px solid #a0aec0;border-radius:12px;background-color:#f7fafc;padding:30px;margin-top:25px;min-height:400px;display:flex;flex-direction:column;justify-content:center;align-items:center;box-shadow:inset 0 0 10px rgba(0,0,0,.1)}#playGameContent p{font-size:1.2em;color:#4a5568;margin-bottom:20px}#playGameCanvas{background-color:#fff;border:1px solid #e2e8f0;border-radius:8px;box-shadow:0 0 15px rgba(0,0,0,.1)}#returnToGamesListBtn{margin-top:25px;padding:12px 25px;background-color:#4299e1;color:#fff;border-radius:10px;font-weight:700;transition:background-color .2s,transform .1s;box-shadow:0 4px 10px rgba(0,0,0,.1)}#returnToGamesListBtn:hover{background-color:#3182ce;transform:translateY(-1px)}@media (max-width:768px){header{flex-direction:column;gap:15px;padding:15px 10px}header h1{font-size:1.8em}.header-controls{justify-content:center}.header-controls button,.header-controls select{padding:8px 12px;font-size:.9em}main{padding:15px 10px}section{padding:20px;border-radius:12px}h2{font-size:1.8em;margin-bottom:15px}form button,form input,form select,form textarea{padding:10px;font-size:1em}form button{padding:10px 20px;font-size:1.1em}.avatar img{width:70px;height:70px}#profileHeader{flex-direction:column;text-align:center;gap:15px;padding-bottom:15px}#profileAvatar img{width:90px;height:90px}#profileInfo p{font-size:1em}#profileStats{gap:10px}#profileStats div{padding:6px 10px;font-size:.85em}#tabs{flex-direction:column;align-items:stretch;gap:5px;padding-bottom:5px}#tabs button{width:100%;border-radius:8px;border-bottom:1px solid #cbd5e0;padding:10px}#tabs button.active{border-bottom:1px solid #4299e1}.tabContent{padding:20px;border-radius:0 0 12px 12px}#rankingTypeButtons{gap:8px;margin-bottom:15px}#rankingTypeButtons button{padding:8px 12px;font-size:.9em}#rankingTable td,#rankingTable th{padding:8px 10px;font-size:.95em}#rankingTable td button.report-user-btn{margin-left:5px;padding:4px 8px;font-size:.75em}.post{padding:15px;margin-bottom:15px}.post-avatar img{width:40px;height:40px;margin-right:10px}.post-author{font-size:1em}.chat-container{padding:15px;margin-bottom:15px}.chat-header{font-size:1em}.chat-message{font-size:.9em}.friends-search{flex-direction:column;gap:10px}.friends-search button,.friends-search input{width:100%;box-sizing:border-box}.user-card{padding:10px;font-size:1em}.user-card button{padding:6px 10px;font-size:.85em}.my-friends li{padding:8px 10px;font-size:1em}.modal-content{padding:20px;border-radius:12px}.close-button{font-size:24px;right:10px;top:10px}.modal-content h2{font-size:1.5em}.modal-content form label{font-size:.95em}.modal-content form input[type=radio]{transform:scale(1)}.modal-content form textarea{padding:10px}.modal-content form button{padding:10px 20px;font-size:1.1em}#gameBuilderTab{padding:20px}.builder-controls{flex-direction:column;align-items:stretch;gap:15px}.builder-inventory,.builder-tools{min-width:unset;width:100%;padding:10px}.builder-tool-item,.inventory-item{padding:8px}.builder-tool-item img,.inventory-item img{width:20px;height:20px}.color-box{width:25px;height:25px}#gameCanvasContainer{min-height:250px}.builder-actions{flex-direction:column;gap:10px}.builder-actions button{width:100%;box-sizing:border-box}.game-list-container{grid-template-columns:1fr;gap:15px}.game-card{padding:15px}.game-card h4{font-size:1.2em}.game-card-actions{flex-direction:column;gap:8px}.game-card-actions button{width:100%;box-sizing:border-box}#playGameContent{padding:20px;min-height:300px}#playGameContent p{font-size:1em}#playGameCanvas{width:100%;height:auto}}</style>
</head>
<body>
<header>
<h1>PoKreGaM</h1>
<div class=header-controls>
<nav id=navMain>
<button id=navGames>Games</button>
<button id=navMarketplace>Marketplace</button>
<button id=navBuild>Build</button>
<button id=navNews>News</button>
<button id=navRanking>Ranking</button>
</nav>
<select id=languageSelector>
<option value=en>English</option>
<option value=pl>Polski</option>
<option value=mk>Македонски</option>
<option value=ru>Русский</option>
<option value=hu>Magyar</option>
</select>
<button id=btnLogin>Login</button>
<button id=btnSignUp>Sign Up</button>
</div>
</header>
<main>
<section id=loginSection class=hidden>
<h2 id=loginTitle>Login</h2>
<form id=loginForm>
<label for=loginUsername>Username:</label>
<input id=loginUsername required autocomplete=username>
<label for=loginPassword>Password:</label>
<input type=password id=loginPassword required autocomplete=current-password>
<button type=submit id=loginSubmit>Login</button>
<p id=loginError class=error-message></p>
<p class=link-text><button type=button id=forgotPasswordLink>Forgot Password?</button></p>
<p class=link-text><button type=button id=toSignUp>Don't have an account? Sign Up</button></p>
</form>
</section>
<section id=signUpSection class=hidden>
<h2 id=signUpTitle>Sign Up</h2>
<form id=signUpForm>
<p id=selectCharacter>Select your character:</p>
<div id=avatarsContainer>
</div>
<label for=signUpUsername>Username:</label>
<input id=signUpUsername required autocomplete=username>
<label for=signUpEmail>Email (optional):</label>
<input type=email id=signUpEmail autocomplete=email>
<label for=signUpCountry>Country:</label>
<select id=signUpCountry required>
<option value=PL>Poland</option>
<option value=US>United States</option>
<option value=MK>North Macedonia</option>
<option value=HU>Hungary</option>
<option value=DE>Germany</option>
</select>
<label for=signUpPassword>Password:</label>
<input type=password id=signUpPassword required autocomplete=new-password>
<label for=signUpBirthdate>Birthdate:</label>
<input type=date id=signUpBirthdate required>
<button type=submit id=signUpSubmit>Sign Up</button>
<p id=signUpError class=error-message></p>
<p class=link-text><button type=button id=toLogin>Already have an account? Login</button></p>
</form>
</section>
<section id=forgotPasswordSection class=hidden>
<h2 id=forgotPasswordTitle>Forgot Password</h2>
<p id=forgotPasswordInstructions>Please enter your email. If an account is associated with it, we will send you your account details (username and password) via email.</p>
<form id=forgotPasswordForm>
<label for=forgotPasswordEmail>Email:</label>
<input type=email id=forgotPasswordEmail required autocomplete=email>
<button type=submit id=sendRecoveryEmail>Send Recovery Email</button>
<p id=forgotPasswordMessage class=success-message></p>
<p id=forgotPasswordError class=error-message></p>
<p class=link-text><button type=button id=backToLoginFromForgot>Back to Login</button></p>
</form>
</section>
<section id=profileSection class=hidden>
<div id=profileHeader>
<div id=profileAvatar>
<img src="" alt="User Avatar">
</div>
<div id=profileInfo>
<p><strong id=profileUsernameLabel>Username:</strong> <span id=profileUsername></span></p>
<p><strong id=profileCountryLabel>Country:</strong> <span id=profileCountry></span></p>
<p><strong id=profileRankingPlaceLabel>XP Ranking Place:</strong> <span id=profileRankingPlace></span></p>
<div id=profileStats>
<div id=profileXPLabel>XP: <span id=profileXP>0</span></div>
<div id=profileLevelLabel>Level: <span id=profileLevel>1</span></div>
<div id=profileFriendsCountLabel>Friends: <span id=profileFriendsCount>0</span></div>
<div id=profileGoldLabel>Gold: <span id=profileGold>0</span></div>
</div>
</div>
</div>
<nav id=tabs>
<button data-tab=gamesTab class=active aria-selected=true id=gamesTabButton>Games</button>
<button data-tab=marketplaceTab aria-selected=false id=marketplaceTabButton>Marketplace</button>
<button data-tab=buildTab aria-selected=false id=buildTabButton>Build</button>
<button data-tab=newGameTab aria-selected=false id=newGameTabButton>New Game</button>
<button data-tab=newsTab aria-selected=false id=newsTabButton>News</button>
<button data-tab=rankingTab aria-selected=false id=rankingTabButton>Ranking</button>
<button data-tab=postsTab aria-selected=false id=postsTabButton>Posts</button>
<button data-tab=friendsTab aria-selected=false id=friendsTabButton>Friends</button>
<button id=checkThisBtn class=hidden>Check this</button>
<button id=btnLogout>Logout</button>
</nav>
<div id=tabContents>
<div id=gamesTab class="tabContent active">
<h3 id=gamesTabTitle>Games</h3>
<p id=gamesWelcomeText>Welcome to your games! Start a new adventure or continue an existing one.</p>
<button id=buildNewGameBtn class=primary>Build New Game</button>
<h4 id=myGamesListTitle>My Games</h4>
<div id=myGamesList class=game-list-container>
</div>
<h4 id=publishedGamesListTitle>Published Games</h4>
<div id=publishedGamesList class=game-list-container>
</div>
</div>
<div id=marketplaceTab class="tabContent hidden">
<h3 id=marketplaceTabTitle>Marketplace</h3>
<p id=marketplaceDescription>Buy and sell items, weapons, and armor here.</p>
<p id=marketplaceUnderConstruction><em>Marketplace is under construction.</em></p>
</div>
<div id=buildTab class="tabContent hidden">
<h3 id=buildTabTitle>Build</h3>
<p id=buildDescription>Craft new items or build your base.</p>
<p id=buildUnderConstruction><em>Build section is under construction.</em></p>
</div>
<div id=newGameTab class="tabContent hidden">
<h3 id=newGameTabTitle>New Game</h3>
<p id=newGameDescription>Choose your game type and begin a new journey.</p>
<p id=newGameComingSoon><em>Feature coming soon.</em></p>
</div>
<div id=newsTab class="tabContent hidden">
<h3 id=newsTabTitle>News</h3>
<p id=newsDescription>Stay updated with the latest game news and community announcements.</p>
<p id=noNewsYet>No news articles available at the moment. Check back soon!</p>
</div>
<div id=rankingTab class="tabContent hidden">
<h3 id=rankingTabTitle>XP Ranking</h3>
<div id=rankingTypeButtons>
<button data-ranking-type=overall class=active id=overallRankingBtn>Overall Ranking</button>
<button data-ranking-type=weekly id=weeklyRankingBtn>Weekly Ranking</button>
<button data-ranking-type=monthly id=monthlyRankingBtn>Monthly Ranking</button>
<button data-ranking-type=yearly id=yearlyRankingBtn>Yearly Ranking</button>
<button data-ranking-type=global id=globalRankingBtn>Global Ranking (by country)</button>
</div>
<table id=rankingTable>
<thead>
<tr>
<th>Place</th>
<th>Username</th>
<th>XP</th>
<th>Level</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<div id=postsTab class="tabContent hidden">
<h3 id=postsTabTitle>Community Posts</h3>
<div id=writePostSection>
<label for=postContent id=writePostLabel>Write your post:</label>
<textarea id=postContent placeholder="What's on your mind?"></textarea>
<button id=publishPostBtn>Publish</button>
<p id=postMessage class=success-message></p>
</div>
<div id=communityPosts>
</div>
</div>
<div id=friendsTab class="tabContent hidden">
<h3 id=friendsTabTitle>Friends</h3>
<div class=friends-search>
<input id=friendSearchInput placeholder="Wyszukaj użytkownika...">
<button id=searchFriendBtn>Szukaj</button>
</div>
<div id=friendSearchResults class=user-list>
</div>
<div class=my-friends>
<h3 id=myFriendsListTitle>Moi Przyjaciele</h3>
<ul id=myFriendsList>
</ul>
</div>
</div>
<div id=gameBuilderTab class="tabContent hidden">
<h3 id=gameBuilderTitle>Build Your Game: <span id=currentBuildingGameName></span></h3>
<div class=builder-controls>
<div class=builder-tools>
<div class="builder-tool-item selected" data-tool=hammer id=toolHammer>
<img src="https://placehold.co/28x28/cccccc/000000?text=🔨" alt=Hammer>
<span id=toolHammerLabel>Hammer (Place Block)</span>
</div>
<div class=builder-tool-item data-tool=eraser id=toolEraser>
<img src="https://placehold.co/28x28/cccccc/000000?text=🧽" alt=Eraser>
<span id=toolEraserLabel>Eraser (Delete Block)</span>
</div>
<div class=builder-tool-item data-tool=bucket id=toolBucket>
<img src="https://placehold.co/28x28/cccccc/000000?text= buckets" alt=Bucket>
<span id=toolBucketLabel>Bucket (Color Block)</span>
</div>
<div class=color-picker-container id=blockColorPicker>
</div>
</div>
<div id=gameCanvasContainer>
<canvas id=gameCanvas></canvas>
</div>
<div class=builder-inventory>
<div class=inventory-category id=modelsCategory>Models</div>
<div id=inventoryModels>
</div>
<div class=inventory-category id=weaponsCategory>Weapons</div>
<div id=inventoryWeapons>
</div>
<div class=inventory-category id=logicCategory>Logic</div>
<div id=inventoryLogic>
</div>
<button id=createNewModelBtn>Create New Model</button>
<button id=selectBlockColorBtn>Select Block Color</button>
</div>
</div>
<div class=builder-actions>
<button id=takeScreenshotBtn>Take Screenshot</button>
<button id=publishGameBtn>Publish Game</button>
<button id=backToGamesListBtn>Back to Games List</button>
</div>
<p id=gameBuilderMessage class=success-message></p>
</div>
<div id=playGameSection class="tabContent hidden">
<h3 id=playGameTitle>Play Game: <span id=playingGameName></span></h3>
<div id=playGameContent>
<p id=playGameInstructions>This is a simulated game. Imagine playing it now!</p>
<canvas id=playGameCanvas></canvas>
<button id=returnToGamesListBtn class=primary>Return to Games List</button>
</div>
</div>
</div>
</section>
<section id=allChatsSection class=hidden>
<h2 id=allChatsTitle>All Private and Game Chats (Guest Access)</h2>
<p id=allChatsDescription>This content is only visible to 'guest' users logged in with password 'Freeaccount'.</p>
<div id=chatsContent>
</div>
</section>
</main>
<div id=reportUserModal class="modal hidden">
<div class=modal-content>
<span class=close-button>&times;</span>
<h2 id=reportUserModalHeader>Zgłoś Użytkownika: <span id=reportUsernameTarget></span></h2>
<p id=reportReasonLabel>Wybierz powód zgłoszenia:</p>
<form id=reportForm>
<label>
<input type=radio name=reportReason value=sexualContent> <span id=sexualContentReason>Seksualna treść</span>
</label><br>
<label>
<input type=radio name=reportReason value=hateSpeech> <span id=hateSpeechReason>Mowa nienawiści / Brzydkie słowa</span>
</label><br>
<label>
<input type=radio name=reportReason value=personalData> <span id=personalDataReason>Udostępnianie danych osobowych</span>
</label><br>
<label>
<input type=radio name=reportReason value=maliciousLink> <span id=maliciousLinkReason>Wysyłanie nieznanych/złośliwych linków</span>
</label><br>
<label>
<input type=radio name=reportReason value=threats> <span id=threatsReason>Grożenie</span>
</label><br>
<label>
<input type=radio name=reportReason value=cheating> <span id=cheatingReason>Cheaty</span>
</label><br>
<label>
<input type=radio name=reportReason value=adminImpersonation> <span id=adminImpersonationReason>Podawanie się za admina</span>
</label><br>
<label>
<input type=radio name=reportReason value=passwordSharing> <span id=passwordSharingReason>Udostępnianie cudzego hasła</span>
</label><br>
<label>
<input type=radio name=reportReason value=other> <span id=otherReason>Inne</span> (opcjonalnie doprecyzuj poniżej)
</label><br>
<textarea id=reportComment placeholder="Dodatkowe uwagi (opcjonalnie)"></textarea><br>
<button type=submit id=sendReportBtn>Wyślij Zgłoszenie</button>
<p id=reportMessage class=error-message></p>
</form>
</div>
</div>
<script>const LANG={en:{login:"Login",signup:"Sign Up",username:"Username",password:"Password",email:"Email (optional)",country:"Country",birthdate:"Birthdate",selectCharacter:"Select your character:",dontHaveAccount:"Don't have an account? Sign Up",alreadyHaveAccount:"Already have an account? Login",rankingXPPlace:"XP Ranking Place:",games:"Games",marketplace:"Marketplace",build:"Build",newGame:"New Game",news:"News",ranking:"Ranking",posts:"Posts",startNewGame:"Start New Game",loginError:"Incorrect username or password.",signUpError:"Please fill in all required fields and select a character.",logout:"Logout",checkThis:"Check this",allChatsTitle:"All Private and Game Chats (Guest Access)",allChatsDescription:"This content is only visible to 'guest' users logged in with password 'Freeaccount'.",forgotPassword:"Forgot Password?",forgotPasswordTitle:"Forgot Password",forgotPasswordInstructions:"Please enter your email. If an account is associated with it, we will send you your account details (username and password) via email.",sendRecoveryEmail:"Send Recovery Email",backToLogin:"Back to Login",recoveryEmailSent:"If an account exists with this email, your account details (username: {username}, password: {password}) have been sent to your email. (Simulation)",recoveryEmailNotFound:"No account found with that email or no email provided for the account. Please check your email or try signing up.",postsTabTitle:"Community Posts",writePostLabel:"Write your post:",publishPostBtn:"Publish",postContentPlaceholder:"What's on your mind?",postPublished:"Post successfully published!",postEmpty:"Post cannot be empty.",overallRanking:"Overall Ranking",weeklyRanking:"Weekly Ranking",monthlyRanking:"Monthly Ranking",yearlyRanking:"Yearly Ranking",globalRankingCountry:"Global Ranking (by country)",rankingTabTitle:"XP Ranking",friends:"Friends",search:"Search",myFriends:"My Friends",noSearchResults:"No search results found.",addFriend:"Add Friend",alreadyFriends:"Already Friends",cannotAddSelf:"Cannot add yourself as a friend.",friendAdded:"User {username} has been added to your friends list.",noFriendsYet:"You don't have any friends yet.",reportUser:"Report",reportUserModalTitle:"Report User:",reportReason:"Select report reason:",sexualContent:"Sexual content",hateSpeech:"Hate speech / Bad language",personalData:"Sharing personal data",maliciousLink:"Sending unknown/malicious links",threats:"Threats",cheating:"Cheating",adminImpersonation:"Impersonating an admin",passwordSharing:"Sharing someone else's password",other:"Other",additionalComments:"Additional comments (optional)",sendReport:"Send Report",reportSuccess:"Report submitted successfully. Thank you!",reportNoReason:"Please select a report reason.",reportCannotReportSelf:"You cannot report yourself.",noPostsYet:"No posts yet. Be the first to share something!",noNewsYet:"No news articles available at the moment. Check back soon!",gamesWelcomeText:"Welcome to your games! Start a new adventure or continue an existing one.",buildNewGame:"Build New Game",myGamesListTitle:"My Games",publishedGamesListTitle:"Published Games",gameBuilderTitle:"Build Your Game:",toolHammerLabel:"Hammer (Place Block)",toolEraserLabel:"Eraser (Delete Block)",toolBucketLabel:"Bucket (Color Block)",modelsCategory:"Models",weaponsCategory:"Weapons",logicCategory:"Logic",createNewModel:"Create New Model",selectBlockColor:"Select Block Color",takeScreenshot:"Take Screenshot",publishGame:"Publish Game",backToGamesList:"Back to Games List",gamePublishedSuccess:"Game '{gameName}' published successfully!",gameSaved:"Game '{gameName}' saved.",gameNamePrompt:"Enter a name for your new game:",selectGameType:"Select game type:",baseTemple:"Base Temple",parkour:"Parkour",island:"Island",playGameTitle:"Play Game:",playGameInstructions:"This is a simulated game. Imagine playing it now!",returnToGamesList:"Return to Games List",gameNotPublished:"This game is not yet published. You can't play it until it's published.",noGamesYet:"You haven't created any games yet. Start building!",noPublishedGames:"No games have been published yet."},pl:{login:"Zaloguj się",signup:"Zarejestruj się",username:"Nazwa użytkownika",password:"Hasło",email:"E-mail (opcjonalnie)",country:"Kraj",birthdate:"Data urodzenia",selectCharacter:"Wybierz swoją postać:",dontHaveAccount:"Nie masz konta? Zarejestruj się",alreadyHaveAccount:"Masz już konto? Zaloguj się",rankingXPPlace:"Miejsce w rankingu XP:",games:"Gry",marketplace:"Rynek",build:"Buduj",newGame:"Nowa gra",news:"Aktualności",ranking:"Ranking",posts:"Posty",startNewGame:"Rozpocznij nową grę",loginError:"Nieprawidłowa nazwa użytkownika lub hasło.",signUpError:"Proszę wypełnić wszystkie wymagane pola i wybrać postać.",logout:"Wyloguj się",checkThis:"Sprawdź to",allChatsTitle:"Wszystkie prywatne czaty i czaty z gier (Dostęp gościa)",allChatsDescription:"Ta zawartość jest widoczna tylko dla użytkowników 'gość' zalogowanych hasłem 'Freeaccount'.",forgotPassword:"Zapomniałeś hasła?",forgotPasswordTitle:"Zapomniałeś hasła",forgotPasswordInstructions:"Proszę podać swój adres e-mail. Jeśli istnieje konto z nim powiązane, wyślemy Ci dane konta (nazwa użytkownika i hasło) e-mailem.",sendRecoveryEmail:"Wyślij e-mail odzyskiwania",backToLogin:"Wróć do logowania",recoveryEmailSent:"Jeśli istnieje konto z tym adresem e-mail, dane Twojego konta (nazwa użytkownika: {username}, hasło: {password}) zostały wysłane na Twój adres e-mail. (Symulacja)",recoveryEmailNotFound:"Nie znaleziono konta z tym adresem e-mail lub nie podano adresu e-mail dla konta. Sprawdź swój adres e-mail lub spróbuj się zarejestrować.",postsTabTitle:"Posty społeczności",writePostLabel:"Napisz swoją wiadomość:",publishPostBtn:"Opublikuj",postContentPlaceholder:"Co masz na myśli?",postPublished:"Post został pomyślnie opublikowany!",postEmpty:"Wiadomość nie może być pusta.",overallRanking:"Ogólny ranking",weeklyRanking:"Ranking tygodniowy",monthlyRanking:"Ranking miesięczny",yearlyRanking:"Ranking roczny",globalRankingCountry:"Globalny ranking (według kraju)",rankingTabTitle:"Ranking XP",friends:"Znajomi",search:"Szukaj",myFriends:"Moi Przyjaciele",noSearchResults:"Brak wyników wyszukiwania.",addFriend:"Dodaj znajomego",alreadyFriends:"Jesteście już znajomymi",cannotAddSelf:"Nie możesz dodać samego siebie do znajomych.",friendAdded:"Użytkownik {username} został dodany do listy znajomych.",noFriendsYet:"Nie masz jeszcze znajomych.",reportUser:"Zgłoś",reportUserModalTitle:"Zgłoś Użytkownika:",reportReason:"Wybierz powód zgłoszenia:",sexualContent:"Treść seksualna",hateSpeech:"Mowa nienawiści / Wulgaryzmy",personalData:"Udostępnianie danych osobowych",maliciousLink:"Wysyłanie nieznanych/złośliwych linków",threats:"Groźby",cheating:"Oszustwa",adminImpersonation:"Podawanie się za administratora",passwordSharing:"Udostępnianie cudzego hasła",other:"Inne",additionalComments:"Dodatkowe uwagi (opcjonalnie)",sendReport:"Wyślij Zgłoszenie",reportSuccess:"Zgłoszenie zostało pomyślnie wysłane. Dziękujemy!",reportNoReason:"Proszę wybrać powód zgłoszenia.",reportCannotReportSelf:"Nie możesz zgłosić samego siebie.",noPostsYet:"Brak postów. Bądź pierwszy, który coś udostępni!",noNewsYet:"Brak dostępnych artykułów z wiadomościami. Sprawdź ponownie wkrótce!",gamesWelcomeText:"Witaj w strefie gier! Rozpocznij nową przygodę lub kontynuuj istniejącą.",buildNewGame:"Zbuduj nową grę",myGamesListTitle:"Moje Gry",publishedGamesListTitle:"Opublikowane Gry",gameBuilderTitle:"Buduj swoją grę:",toolHammerLabel:"Młotek (Ustaw blok)",toolEraserLabel:"Gumka (Usuń blok)",toolBucketLabel:"Wiadro (Koloruj blok)",modelsCategory:"Modele",weaponsCategory:"Bronie",logicCategory:"Logika",createNewModel:"Stwórz nowy model",selectBlockColor:"Wybierz kolor bloku",takeScreenshot:"Zrób zrzut ekranu",publishGame:"Opublikuj grę",backToGamesList:"Wróć do listy gier",gamePublishedSuccess:"Gra '{gameName}' została pomyślnie opublikowana!",gameSaved:"Gra '{gameName}' zapisana.",gameNamePrompt:"Podaj nazwę dla swojej nowej gry:",selectGameType:"Wybierz typ gry:",baseTemple:"Świątynia Bazowa",parkour:"Prakour",island:"Wyspa",playGameTitle:"Graj w grę:",playGameInstructions:"To jest symulowana gra. Wyobraź sobie, że teraz w nią grasz!",returnToGamesList:"Wróć do listy gier",gameNotPublished:"Ta gra nie jest jeszcze opublikowana. Nie możesz w nią grać, dopóki nie zostanie opublikowana.",noGamesYet:"Nie stworzyłeś jeszcze żadnych gier. Zacznij budować!",noPublishedGames:"Żadne gry nie zostały jeszcze opublikowane."},mk:{login:"Најава",signup:"Регистрација",username:"Корисничко име",password:"Лозинка",email:"Е-пошта (опционално)",country:"Држава",birthdate:"Датум на раѓање",selectCharacter:"Избери го својот карактер:",dontHaveAccount:"Немате сметка? Регистрирајте се",alreadyHaveAccount:"Веќе имате сметка? Најавете се",rankingXPPlace:"Место на ранг листата по XP:",games:"Игри",marketplace:"Пазар",build:"Изградба",newGame:"Нова игра",news:"Вести",ranking:"Ранг листа",posts:"Објави",startNewGame:"Започни нова игра",loginError:"Погрешно корисничко име или лозинка.",signUpError:"Ве молиме пополнете ги сите задолжителни полиња и изберете карактер.",logout:"Одјави се",checkThis:"Провери го ова",allChatsTitle:"Сите приватни разговори и разговори од игри (Гостински пристап)",allChatsDescription:"Оваа содржина е видлива само за 'гостин' корисници најавени со лозинката 'Freeaccount'.",forgotPassword:"Заборавена лозинка?",forgotPasswordTitle:"Заборавена лозинка",forgotPasswordInstructions:"Ве молиме внесете ја вашата е-пошта. Доколку постои сметка поврзана со неа, ќе ви ги испратиме деталите за вашата сметка (корисничко име и лозинка) по е-пошта.",sendRecoveryEmail:"Испрати е-пошта за обнова",backToLogin:"Назад на Најава",recoveryEmailSent:"Доколку постои сметка со оваа е-пошта, деталите за вашата сметка (корисничко име: {username}, лозинка: {password}) се испратени на вашата е-пошта. (Симулација)",recoveryEmailNotFound:"Не е пронајдена сметка со таа е-пошта или не е обезбедена е-попошта за сметката. Ве молиме проверете ја вашата е-пошта или обидете се да се регистрирате.",postsTabTitle:"Објави на заедницата",writePostLabel:"Напиши ја вашата објава:",publishPostBtn:"Објави",postContentPlaceholder:"Што ви е на ум?",postPublished:"Објавата е успешно објавена!",postEmpty:"Објавата не може да биде празна.",overallRanking:"Вкупна ранг листа",weeklyRanking:"Неделна ранг листа",monthlyRanking:"Месечна ранг листа",yearlyRanking:"Годишна ранг листа",globalRankingCountry:"Глобална ранг листа (по држава)",rankingTabTitle:"XP Ранг листа",friends:"Пријатели",search:"Барај",myFriends:"Мои Пријатели",noSearchResults:"Нема резултати од пребарувањето.",addFriend:"Додај пријател",alreadyFriends:"Веќе пријатели",cannotAddSelf:"Не можете да се додадете себеси како пријател.",friendAdded:"Корисникот {username} е додаден во вашите пријатели.",noFriendsYet:"Сè уште немате пријатели.",reportUser:"Пријави",reportUserModalTitle:"Пријави Корисник:",reportReason:"Изберете причина за пријава:",sexualContent:"Сексуална содржина",hateSpeech:"Говор на омраза / Лош јазик",personalData:"Споделување лични податоци",maliciousLink:"Испраќање непознати/злонамерни линкови",threats:"Закани",cheating:"Мамење",adminImpersonation:"Претставување како администратор",passwordSharing:"Споделување туѓа лозинка",other:"Друго",additionalComments:"Дополнителни коментари (опционално)",sendReport:"Испрати Пријава",reportSuccess:"Пријавата е успешно поднесена. Благодариме!",reportNoReason:"Ве молиме изберете причина за пријава.",reportCannotReportSelf:"Не можете да се пријавите себеси.",noPostsYet:"Сè уште нема објави. Бидете првиот што ќе сподели нешто!",noNewsYet:"Во моментов нема достапни вести. Проверете наскоро!",gamesWelcomeText:"Добредојдовте во вашата зона за игри! Започнете нова авантура или продолжете со постоечка.",buildNewGame:"Изгради нова игра",myGamesListTitle:"Мои Игри",publishedGamesListTitle:"Објавени Игри",gameBuilderTitle:"Изгради ја твојата игра:",toolHammerLabel:"Чекан (Постави блок)",toolEraserLabel:"Гума (Избриши блок)",toolBucketLabel:"Кофа (Боја блок)",modelsCategory:"Модели",weaponsCategory:"Оружја",logicCategory:"Логика",createNewModel:"Креирај нов модел",selectBlockColor:"Избери боја на блок",takeScreenshot:"Направи скриншот",publishGame:"Објави игра",backToGamesList:"Назад кон листата со игри",gamePublishedSuccess:"Играта '{gameName}' е успешно објавена!",gameSaved:"Играта '{gameName}' е зачувана.",gameNamePrompt:"Внесете име за вашата нова игра:",selectGameType:"Изберете тип на игра:",baseTemple:"Основен Храм",parkour:"Паркур",island:"Остров",playGameTitle:"Играј игра:",playGameInstructions:"Ова е симулирана игра. Замислете дека ја играте сега!",returnToGamesList:"Врати се на листата со игри",gameNotPublished:"Оваа игра сè уште не е објавена. Не можете да ја играте додека не биде објавена.",noGamesYet:"Сè уште немате креирано игри. Започнете со градење!",noPublishedGames:"Сè уште нема објавени игри."},ru:{login:"Вход",signup:"Регистрация",username:"Имя пользователя",password:"Пароль",email:"Электронная почта (необязательно)",country:"Страна",birthdate:"Дата рождения",selectCharacter:"Выберите своего персонажа:",dontHaveAccount:"Нет аккаунта? Зарегистрироваться",alreadyHaveAccount:"Уже есть аккаунт? Войти",rankingXPPlace:"Место в рейтинге XP:",games:"Игры",marketplace:"Торговая площадка",build:"Строить",newGame:"Новая игра",news:"Новости",ranking:"Рейтинг",posts:"Сообщения",startNewGame:"Начать новую игру",loginError:"Неверное имя пользователя или пароль.",signUpError:"Пожалуйста, заполните все обязательные поля и выберите персонажа.",logout:"Выйти",checkThis:"Проверить это",allChatsTitle:"Все личные и игровые чаты (гостевой доступ)",allChatsDescription:"Этот контент виден только пользователям 'guest', вошедшим с паролем 'Freeaccount'.",forgotPassword:"Забыли пароль?",forgotPasswordTitle:"Забыли пароль",forgotPasswordInstructions:"Пожалуйста, введите свой адрес электронной почты. Если аккаунт связан с ней, мы отправим вам данные аккаунта (имя пользователя и пароль) по электронной почте.",sendRecoveryEmail:"Отправить письмо для восстановления",backToLogin:"Вернуться ко входу",recoveryEmailSent:"Если аккаунт существует с этой электронной почтой, данные вашего аккаунта (имя пользователя: {username}, пароль: {password}) были отправлены на вашу электронную почту. (Симуляция)",recoveryEmailNotFound:"Аккаунт с такой электронной почтой не найден или для аккаунта не указана электронная почта. Пожалуйста, проверьте свою электронную почту или попробуйте зарегистрироваться.",postsTabTitle:"Сообщения сообщества",writePostLabel:"Напишите свое сообщение:",publishPostBtn:"Опубликовать",postContentPlaceholder:"Что у вас на уме?",postPublished:"Сообщение успешно опубликовано!",postEmpty:"Сообщение не может быть пустым.",overallRanking:"Общий рейтинг",weeklyRanking:"Еженедельный рейтинг",monthlyRanking:"Ежемесячный рейтинг",yearlyRanking:"Ежегодный рейтинг",globalRankingCountry:"Глобальный рейтинг (по странам)",rankingTabTitle:"Рейтинг XP",friends:"Друзья",search:"Поиск",myFriends:"Мои друзья",noSearchResults:"Результатов поиска не найдено.",addFriend:"Добавить в друзья",alreadyFriends:"Уже друзья",cannotAddSelf:"Нельзя добавить себя в друзья.",friendAdded:"Пользователь {username} добавлен в ваш список друзей.",noFriendsYet:"У вас пока нет друзей.",reportUser:"Пожаловаться",reportUserModalTitle:"Пожаловаться на пользователя:",reportReason:"Выберите причину жалобы:",sexualContent:"Сексуальный контент",hateSpeech:"Разжигание ненависти / Нецензурные выражения",personalData:"Разглашение личных данных",maliciousLink:"Отправка неизвестных/вредоносных ссылок",threats:"Угрозы",cheating:"Читерство",adminImpersonation:"Выдача себя за администратора",passwordSharing:"Совместное использование чужого пароля",other:"Другое",additionalComments:"Дополнительные комментарии (необязательно)",sendReport:"Отправить жалобу",reportSuccess:"Жалоба успешно отправлена. Спасибо!",reportNoReason:"Пожалуйста, выберите причину жалобы.",reportCannotReportSelf:"Вы не можете пожаловаться на себя.",noPostsYet:"Пока нет сообщений. Будьте первым, кто что-то опубликует!",noNewsYet:"На данный момент нет новостных статей. Заходите позже!",gamesWelcomeText:"Добро пожаловать в ваши игры! Начните новое приключение или продолжите существующее.",buildNewGame:"Создать новую игру",myGamesListTitle:"Мои игры",publishedGamesListTitle:"Опубликованные игры",gameBuilderTitle:"Создайте свою игру:",toolHammerLabel:"Молоток (Разместить блок)",toolEraserLabel:"Ластик (Удалить блок)",toolBucketLabel:"Ведро (Раскрасить блок)",modelsCategory:"Модели",weaponsCategory:"Оружие",logicCategory:"Логика",createNewModel:"Создать новую модель",selectBlockColor:"Выбрать цвет блока",takeScreenshot:"Сделать скриншот",publishGame:"Опубликовать игру",backToGamesList:"Вернуться к списку игр",gamePublishedSuccess:"Игра '{gameName}' успешно опубликована!",gameSaved:"Игра '{gameName}' сохранена.",gameNamePrompt:"Введите название для вашей новой игры:",selectGameType:"Выберите тип игры:",baseTemple:"Базовый храм",parkour:"Паркур",island:"Остров",playGameTitle:"Играть в игру:",playGameInstructions:"Это симулированная игра. Представьте, что вы играете прямо сейчас!",returnToGamesList:"Вернуться к списку игр",gameNotPublished:"Эта игра еще не опубликована. Вы не можете играть в нее, пока она не будет опубликована.",noGamesYet:"Вы еще не создали ни одной игры. Начните строить!",noPublishedGames:"Игры пока не опубликованы."},hu:{login:"Bejelentkezés",signup:"Regisztráció",username:"Felhasználónév",password:"Jelszó",email:"E-mail (opcionális)",country:"Ország",birthdate:"Születési dátum",selectCharacter:"Válassza ki karakterét:",dontHaveAccount:"Nincs fiókja? Regisztráljon",alreadyHaveAccount:"Már van fiókja? Jelentkezzen be",rankingXPPlace:"XP rangsor helyezés:",games:"Játékok",marketplace:"Piactér",build:"Építés",newGame:"Új játék",news:"Hírek",ranking:"Rangsor",posts:"Bejegyzések",startNewGame:"Új játék indítása",loginError:"Hibás felhasználónév vagy jelszó.",signUpError:"Kérjük, töltse ki az összes kötelező mezőt, és válasszon karaktert.",logout:"Kijelentkezés",checkThis:"Nézze meg ezt",allChatsTitle:"Minden privát és játék chat (Vendég hozzáférés)",allChatsDescription:"Ez a tartalom csak a 'guest' felhasználók számára látható, akik 'Freeaccount' jelszóval jelentkeztek be.",forgotPassword:"Elfelejtett jelszó?",forgotPasswordTitle:"Elfelejtett jelszó",forgotPasswordInstructions:"Kérjük, adja meg e-mail címét. Ha van hozzá fiók, elküldjük fiókadatait (felhasználónév és jelszó) e-mailben.",sendRecoveryEmail:"Helyreállítási e-mail küldése",backToLogin:"Vissza a bejelentkezéshez",recoveryEmailSent:"Ha létezik fiók ezzel az e-mail címmel, fiókadatai (felhasználónév: {username}, jelszó: {password}) elküldésre kerültek az e-mail címére. (Szimuláció)",recoveryEmailNotFound:"Nincs fiók ezzel az e-mail címmel, vagy nincs e-mail cím megadva a fiókhoz. Kérjük, ellenőrizze e-mail címét, vagy próbálja meg regisztrálni.",postsTabTitle:"Közösségi bejegyzések",writePostLabel:"Írja meg bejegyzését:",publishPostBtn:"Közzététel",postContentPlaceholder:"Mi jár a fejében?",postPublished:"Bejegyzés sikeresen közzétéve!",postEmpty:"A bejegyzés nem lehet üres.",overallRanking:"Összesített rangsor",weeklyRanking:"Heti rangsor",monthlyRanking:"Havi rangsor",yearlyRanking:"Éves rangsor",globalRankingCountry:"Globális rangsor (ország szerint)",rankingTabTitle:"XP rangsor",friends:"Barátok",search:"Keresés",myFriends:"Barátaim",noSearchResults:"Nincs találat.",addFriend:"Barát hozzáadása",alreadyFriends:"Már barátok",cannotAddSelf:"Nem adhatja hozzá magát barátként.",friendAdded:"{username} felhasználó hozzá lett adva a barátlistájához.",noFriendsYet:"Még nincsenek barátai.",reportUser:"Jelentés",reportUserModalTitle:"Felhasználó jelentése:",reportReason:"Válassza ki a jelentés okát:",sexualContent:"Szexuális tartalom",hateSpeech:"Gyűlöletbeszéd / Csúnya nyelv",personalData:"Személyes adatok megosztása",maliciousLink:"Ismeretlen/rosszindulatú linkek küldése",threats:"Fenyegetések",cheating:"Csalás",adminImpersonation:"Admin megszemélyesítése",passwordSharing:"Más jelszavának megosztása",other:"Egyéb",additionalComments:"További megjegyzések (opcionális)",sendReport:"Jelentés küldése",reportSuccess:"Jelentés sikeresen elküldve. Köszönjük!",reportNoReason:"Kérjük, válassza ki a jelentés okát.",reportCannotReportSelf:"Nem jelentheti magát.",noPostsYet:"Még nincsenek bejegyzések. Legyen Ön az első, aki megoszt valamit!",noNewsYet:"Jelenleg nincsenek hírek. Nézzen vissza később!",gamesWelcomeText:"Üdvözöljük a játékai között! Kezdjen új kalandot, vagy folytasson egy meglévőt.",buildNewGame:"Új játék építése",myGamesListTitle:"Játékaim",publishedGamesListTitle:"Közzétett játékok",gameBuilderTitle:"Építse meg játékát:",toolHammerLabel:"Kalapács (Blokk elhelyezése)",toolEraserLabel:"Radír (Blokk törlése)",toolBucketLabel:"Vödör (Blokk színezése)",modelsCategory:"Modellek",weaponsCategory:"Fegyverek",logicCategory:"Logika",createNewModel:"Új modell létrehozása",selectBlockColor:"Blokk színének kiválasztása",takeScreenshot:"Képernyőfelvétel készítése",publishGame:"Játék közzététele",backToGamesList:"Vissza a játéklistához",gamePublishedSuccess:"A(z) '{gameName}' játék sikeresen közzétéve!",gameSaved:"A(z) '{gameName}' játék mentve.",gameNamePrompt:"Adjon nevet új játékának:",selectGameType:"Válassza ki a játék típusát:",baseTemple:"Alap templom",parkour:"Parkour",island:"Sziget",playGameTitle:"Játék indítása:",playGameInstructions:"Ez egy szimulált játék. Képzelje el, hogy most játszik!",returnToGamesList:"Vissza a játéklistához",gameNotPublished:"Ez a játék még nincs közzétéve. Nem játszhatja, amíg nem lesz közzétéve.",noGamesYet:"Még nem hozott létre játékokat. Kezdjen építeni!",noPublishedGames:"Még nincsenek közzétett játékok."}},$=e=>document.getElementById(e),show=e=>e&&e.classList.remove("hidden"),hide=e=>e&&e.classList.add("hidden"),sanitize=e=>String(e).replace(/[<>]/g,"");let currentLang=localStorage.getItem("pokregamLang")||"en",currentUser=null,users=JSON.parse(localStorage.getItem("pokregamUsers"))||[],posts=JSON.parse(localStorage.getItem("pokregamPosts"))||[],games=JSON.parse(localStorage.getItem("pokregamGames"))||[];async function saveUserToLocalStorage(e){const t=users.findIndex((t=>t.username===e.username));-1!==t?users[t]={...users[t],...e}:users.push(e),localStorage.setItem("pokregamUsers",JSON.stringify(users)),console.log("User saved/updated in local storage (simulated):",e),window.getCurrentUserId()&&await window.saveUserDataToFirestore(e)}async function loadUserFromLocalStorage(e){return users.find((t=>t.username===e))}async function updateProfileUI(e){if(!e)return void console.warn("No user data provided to updateProfileUI.");const t=e||currentUser;t?($("profileUsername").textContent=sanitize(t.username||"N/A"),$("profileCountry").textContent=sanitize(t.country||"N/A"),$("profileXP").textContent=void 0!==t.xp?t.xp:0,$("profileLevel").textContent=void 0!==t.level?t.level:1,$("profileFriendsCount").textContent=t.friends?t.friends.length:0,$("profileGold").textContent=void 0!==t.gold?t.gold:0,$("profileAvatar").querySelector("img").src=t.avatar||"https://placehold.co/80x80/cccccc/000000?text=👤",updateRanking(),loadFriendsList(),loadMyGames(),loadPublishedGames()):clearProfileUI()}function clearProfileUI(){$("profileUsername").textContent="",$("profileCountry").textContent="",$("profileXP").textContent="0",$("profileLevel").textContent="1",$("profileFriendsCount").textContent="0",$("profileGold").textContent="0",$("profileAvatar").querySelector("img").src="https://placehold.co/80x80/cccccc/000000?text=👤",$("profileRankingPlace").textContent="",$("myFriendsList").innerHTML="",$("myGamesList").innerHTML="",$("publishedGamesList").innerHTML=""}function translateUI(e){currentLang=e,localStorage.setItem("pokregamLang",e);const t=LANG[e];$("navGames").textContent=t.games,$("navMarketplace").textContent=t.marketplace,$("navBuild").textContent=t.build,$("navNews").textContent=t.news,$("navRanking").textContent=t.ranking,$("btnLogin").textContent=t.login,$("btnSignUp").textContent=t.signup,$("btnLogout").textContent=t.logout,$("checkThisBtn").textContent=t.checkThis,$("loginTitle").textContent=t.login,$("loginForm").querySelector('label[for="loginUsername"]').textContent=t.username+":",$("loginForm").querySelector('label[for="loginPassword"]').textContent=t.password+":",$("loginSubmit").textContent=t.login,$("loginError").textContent="",$("toSignUp").textContent=t.dontHaveAccount,$("forgotPasswordLink").textContent=t.forgotPassword,$("signUpTitle").textContent=t.signup,$("selectCharacter").textContent=t.selectCharacter,$("signUpForm").querySelector('label[for="signUpUsername"]').textContent=t.username+":",$("signUpForm").querySelector('label[for="signUpEmail"]').textContent=t.email+":",$("signUpForm").querySelector('label[for="signUpCountry"]').textContent=t.country+":",$("signUpForm").querySelector('label[for="signUpPassword"]').textContent=t.password+":",$("signUpForm").querySelector('label[for="signUpBirthdate"]').textContent=t.birthdate+":",$("signUpSubmit").textContent=t.signup,$("signUpError").textContent="",$("toLogin").textContent=t.alreadyHaveAccount,$("forgotPasswordTitle").textContent=t.forgotPasswordTitle,$("forgotPasswordInstructions").textContent=t.forgotPasswordInstructions,$("forgotPasswordForm").querySelector('label[for="forgotPasswordEmail"]').textContent=t.email+":",$("sendRecoveryEmail").textContent=t.sendRecoveryEmail,$("backToLoginFromForgot").textContent=t.backToLogin,$("forgotPasswordMessage").textContent="",$("forgotPasswordError").textContent="",$("profileUsernameLabel").textContent=t.username+": ",$("profileCountryLabel").textContent=t.country+": ",$("profileRankingPlaceLabel").textContent=t.rankingXPPlace+" ",$("profileXPLabel").childNodes[0].nodeValue="XP: ",$("profileLevelLabel").childNodes[0].nodeValue="Level: ",$("profileFriendsCountLabel").childNodes[0].nodeValue="Friends: ",$("profileGoldLabel").childNodes[0].nodeValue="Gold: ",$("gamesTabButton").textContent=t.games,$("marketplaceTabButton").textContent=t.marketplace,$("buildTabButton").textContent=t.build,$("newGameTabButton").textContent=t.newGame,$("newsTabButton").textContent=t.news,$("rankingTabButton").textContent=t.ranking,$("postsTabButton").textContent=t.posts,$("friendsTabButton").textContent=t.friends,$("gamesTabTitle").textContent=t.games,$("gamesWelcomeText").textContent=t.gamesWelcomeText,$("buildNewGameBtn").textContent=t.buildNewGame,$("myGamesListTitle").textContent=t.myGamesListTitle,$("publishedGamesListTitle").textContent=t.publishedGamesListTitle,$("marketplaceTabTitle").textContent=t.marketplace,$("marketplaceDescription").textContent=t.marketplaceDescription,$("marketplaceUnderConstruction").textContent=t.marketplaceUnderConstruction,$("buildTabTitle").textContent=t.build,$("buildDescription").textContent=t.buildDescription,$("buildUnderConstruction").textContent=t.buildUnderConstruction,$("newGameTabTitle").textContent=t.newGame,$("newGameDescription").textContent=t.newGameDescription,$("newGameComingSoon").textContent=t.newGameComingSoon,$("newsTabTitle").textContent=t.news,$("newsDescription").textContent=t.newsDescription,$("noNewsYet").textContent=t.noNewsYet,$("rankingTabTitle").textContent=t.rankingTabTitle,$("overallRankingBtn").textContent=t.overallRanking,$("weeklyRankingBtn").textContent=t.weeklyRanking,$("monthlyRankingBtn").textContent=t.monthlyRanking,$("yearlyRankingBtn").textContent=t.yearlyRanking,$("globalRankingBtn").textContent=t.globalRankingCountry;const n=$("rankingTable").querySelectorAll("th");n.length>=4&&(n[0].textContent=t.rankingTablePlace||"Place",n[1].textContent=t.rankingTableUsername||"Username",n[2].textContent=t.rankingTableXP||"XP",n[3].textContent=t.rankingTableLevel||"Level"),$("postsTabTitle").textContent=t.postsTabTitle,$("writePostLabel").textContent=t.writePostLabel,$("postContent").placeholder=t.postContentPlaceholder,$("publishPostBtn").textContent=t.publishPostBtn,$("postMessage").textContent="",$("friendsTabTitle").textContent=t.friends,$("friendSearchInput").placeholder=t.friendSearchInputPlaceholder,$("searchFriendBtn").textContent=t.search,$("myFriendsListTitle").textContent=t.myFriends,$("gameBuilderTitle").textContent=t.gameBuilderTitle,$("toolHammerLabel").textContent=t.toolHammerLabel,$("toolEraserLabel").textContent=t.toolEraserLabel,$("toolBucketLabel").textContent=t.toolBucketLabel,$("modelsCategory").textContent=t.modelsCategory,$("weaponsCategory").textContent=t.weaponsCategory,$("logicCategory").textContent=t.logicCategory,$("createNewModelBtn").textContent=t.createNewModel,$("selectBlockColorBtn").textContent=t.selectBlockColor,$("takeScreenshotBtn").textContent=t.takeScreenshot,$("publishGameBtn").textContent=t.publishGame,$("backToGamesListBtn").textContent=t.backToGamesList,$("gameBuilderMessage").textContent="",$("playGameTitle").textContent=t.playGameTitle,$("playGameInstructions").textContent=t.playGameInstructions,$("returnToGamesListBtn").textContent=t.returnToGamesList,$("allChatsTitle").textContent=t.allChatsTitle,$("allChatsDescription").textContent=t.allChatsDescription,$("reportUserModalHeader").childNodes[0].nodeValue=t.reportUserModalTitle,$("reportReasonLabel").textContent=t.reportReason,$("sexualContentReason").textContent=t.sexualContent,$("hateSpeechReason").textContent=t.hateSpeech,$("personalDataReason").textContent=t.personalData,$("maliciousLinkReason").textContent=t.maliciousLink,$("threatsReason").textContent=t.threats,$("cheatingReason").textContent=t.cheating,$("adminImpersonationReason").textContent=t.adminImpersonation,$("passwordSharingReason").textContent=t.passwordSharing,$("otherReason").textContent=t.other,$("reportComment").placeholder=t.additionalComments,$("sendReportBtn").textContent=t.sendReport,$("reportMessage").textContent=""}const avatars=[{id:"avatar1",name:"Smily Boy",src:"https://placehold.co/80x80/cccccc/000000?text=😀"},{id:"avatar2",name:"Warrior Girl",src:"https://placehold.co/80x80/cccccc/000000?text=👩‍🎤"},{id:"avatar3",name:"Zebra",src:"https://placehold.co/80x80/cccccc/000000?text=🦓"},{id:"avatar4",name:"King Of Water",src:"https://placehold.co/80x80/cccccc/000000?text=👑"},{id:"avatar5",name:"Robot",src:"https://placehold.co/80x80/cccccc/000000?text=🤖"},{id:"avatar6",name:"Cat",src:"https://placehold.co/80x80/cccccc/000000?text=🐱"},{id:"avatar7",name:"Dog",src:"https://placehold.co/80x80/cccccc/000000?text=🐶"},{id:"avatar8",name:"Alien",src:"https://placehold.co/80x80/cccccc/000000?text=👽"},{id:"avatar9",name:"Ninja",src:"https://placehold.co/80x80/cccccc/000000?text=🥷"},{id:"avatar10",name:"Wizard",src:"https://placehold.co/80x80/cccccc/000000?text=🧙"}],allChats=[{type:"private",participants:["UserA","UserB"],messages:[{sender:"UserA",text:"Hey, spotkałeś się z tą nową misją?",time:"10:05"},{sender:"UserB",text:"Tak, jest super trudna! Potrzebuję pomocy.",time:"10:07"},{sender:"UserA",text:"Jasne, mogę pomóc wieczorem.",time:"10:08"}]},{type:"game",game:"Dragon Slayer",messages:[{sender:"Player1",text:"Ktoś na raidzie o 20:00?",time:"11:15"},{sender:"Player2",text:"Ja będę!",time:"11:16"},{sender:"Player1",text:"Ok, zbieramy ekipę!",time:"11:17"}]},{type:"private",participants:["GraczX","GraczY"],messages:[{sender:"GraczX",text:"Widziałeś ten nowy item?",time:"12:01"},{sender:"GraczY",text:"O tak, jest niesamowity! Ale drogi...",time:"12:03"}]},{type:"game",game:"PoKreGaM Football",messages:[{sender:"Fanatik",text:"GOOOOOOL!!!",time:"13:30"},{sender:"Rywal",text:"Foul! To był faul!",time:"13:31"},{sender:"Fanatik",text:"Sędzia puścił, gramy dalej!",time:"13:32"}]},{type:"private",participants:["Admin","SupportUser"],messages:[{sender:"Admin",text:"Problem z serwerem rozwiązany.",time:"14:00"},{sender:"SupportUser",text:"Dzięki za szybką naprawę!",time:"14:01"}]}];function hideAllSections(){document.querySelectorAll("section").forEach((e=>hide(e)))}function showSection(e){hideAllSections(),show(e)}async function handleLogin(e){e.preventDefault();const t=$("loginUsername").value,n=$("loginPassword").value,a=$("loginError"),r=users.find((e=>e.username===t&&e.password===n));if(r){if(currentUser=r,localStorage.setItem("currentUser",JSON.stringify(currentUser)),a.textContent="",window.getCurrentUserId()){const e=await window.loadUserDataFromFirestore();e&&(currentUser={...currentUser,...e})}updateProfileUI(currentUser),showSection($("profileSection"))}else a.textContent=LANG[currentLang].loginError}async function handleSignUp(e){e.preventDefault();const t=$("signUpUsername").value,n=$("signUpEmail").value,a=$("signUpCountry").value,r=$("signUpPassword").value,o=$("signUpBirthdate").value,s=$("signUpError"),i=document.querySelector(".avatar.selected"),l=i?i.querySelector("img").src:null;if(!(t&&r&&o&&i))return void(s.textContent=LANG[currentLang].signUpError);if(users.some((e=>e.username===t)))return void(s.textContent="Username already taken.");const c={username:sanitize(t),email:sanitize(n),country:sanitize(a),password:r,birthdate:o,avatar:l,xp:0,level:1,friends:[],gold:0,games:[]};await saveUserToLocalStorage(c),currentUser=c,updateProfileUI(currentUser),showSection($("profileSection"))}function handleLogout(){currentUser=null,localStorage.removeItem("currentUser"),window.firebaseAuth&&window.firebaseAuth.signOut().then((()=>{console.log("Signed out from Firebase.")})).catch((e=>{console.error("Error signing out from Firebase:",e)})),clearProfileUI(),showSection($("loginSection"))}async function handleForgotPassword(e){e.preventDefault();const t=$("forgotPasswordEmail").value,n=users.find((e=>e.email===t)),a=$("forgotPasswordMessage"),r=$("forgotPasswordError");n?(a.textContent=LANG[currentLang].recoveryEmailSent.replace("{username}",n.username).replace("{password}",n.password),r.textContent=""):(r.textContent=LANG[currentLang].recoveryEmailNotFound,a.textContent="")}function switchTab(e){document.querySelectorAll(".tabContent").forEach((e=>hide(e))),document.querySelectorAll("#tabs button").forEach((e=>e.classList.remove("active"))),show($(e)),$(`${e}Button`).classList.add("active"),"rankingTab"===e?updateRanking():"postsTab"===e?loadAllPosts():"friendsTab"===e?loadFriendsList():"gamesTab"===e&&(loadMyGames(),loadPublishedGames())}function renderAvatars(){const e=$("avatarsContainer");e.innerHTML="",avatars.forEach((t=>{const n=document.createElement("div");n.classList.add("avatar"),n.dataset.id=t.id,n.innerHTML=`<img src="${t.src}" alt="${t.name}"><span>${t.name}</span>`,n.addEventListener("click",(()=>{document.querySelectorAll(".avatar").forEach((e=>e.classList.remove("selected"))),n.classList.add("selected")})),e.appendChild(n)}))}function updateRanking(e="overall"){let t=[];if("overall"===e)t=[...users].sort(((e,t)=>t.xp-e.xp));else if("global"===e){const e={};users.forEach((t=>{e[t.country]=(e[t.country]||0)+t.xp})),t=Object.entries(e).map((([e,t])=>({username:e,xp:t,level:"N/A"}))).sort(((e,t)=>t.xp-e.xp))}else t=[...users].sort(((e,t)=>t.xp-e.xp));const n=$("rankingTable").querySelector("tbody");if(n.innerHTML="",t.forEach(((e,t)=>{const a=n.insertRow(),r=a.insertCell(),o=a.insertCell(),s=a.insertCell(),i=a.insertCell(),l=a.insertCell();if(r.textContent=t+1,o.textContent=sanitize(e.username),s.textContent=e.xp,i.textContent=e.level,currentUser&&currentUser.username!==e.username){const t=document.createElement("button");t.classList.add("report-user-btn"),t.textContent=LANG[currentLang].reportUser,t.addEventListener("click",(()=>openReportModal(e.username))),l.appendChild(t)}})),currentUser){const e=t.findIndex((e=>e.username===currentUser.username));$("profileRankingPlace").textContent=-1!==e?e+1:LANG[currentLang].notRanked||"N/A"}}window.updateProfileUI=function(e){e?(currentUser={...currentUser,...e},$("profileUsername").textContent=sanitize(currentUser.username||"N/A"),$("profileCountry").textContent=sanitize(currentUser.country||"N/A"),$("profileXP").textContent=void 0!==currentUser.xp?currentUser.xp:0,$("profileLevel").textContent=void 0!==currentUser.level?currentUser.level:1,$("profileFriendsCount").textContent=currentUser.friends?currentUser.friends.length:0,$("profileGold").textContent=void 0!==currentUser.gold?currentUser.gold:0,$("profileAvatar").querySelector("img").src=currentUser.avatar||"https://placehold.co/80x80/cccccc/000000?text=👤",updateRanking(),loadFriendsList(),loadMyGames(),loadPublishedGames()):console.warn("No user data provided to updateProfileUI.")};let unsubscribePosts=null;function loadAllPosts(){const e=$("communityPosts");e.innerHTML="",unsubscribePosts&&unsubscribePosts(),unsubscribePosts=window.getPostsFromFirestore((t=>{e.innerHTML="",0!==t.length?t.forEach((t=>{const n=document.createElement("div");n.classList.add("post");const a=document.createElement("div");a.classList.add("post-header");const r=document.createElement("div");r.classList.add("post-avatar");const o=users.find((e=>e.username===t.authorUsername))||{avatar:"https://placehold.co/40x40/cccccc/000000?text=👤"};r.innerHTML=`<img src="${o.avatar}" alt="${sanitize(t.authorUsername)}">`;const s=document.createElement("div");s.classList.add("post-info"),s.innerHTML=`\n                    <div class="post-author">${sanitize(t.authorUsername)}</div>\n                    <div class="post-time">${new Date(t.timestamp?.toDate?t.timestamp.toDate():t.timestamp).toLocaleString()}</div>\n                `,a.appendChild(r),a.appendChild(s);const i=document.createElement("div");i.classList.add("post-content"),i.textContent=sanitize(t.content),n.appendChild(a),n.appendChild(i),e.appendChild(n)})):e.innerHTML=`<p>${LANG[currentLang].noPostsYet}</p>`}))}async function publishPost(){const e=$("postContent"),t=$("postMessage"),n=e.value.trim();if(!currentUser)return t.textContent="You must be logged in to post.",t.classList.remove("success-message"),void t.classList.add("error-message");if(""===n)return t.textContent=LANG[currentLang].postEmpty,t.classList.remove("success-message"),void t.classList.add("error-message");await window.addPostToFirestore({authorUsername:currentUser.username,content:n})?(t.textContent=LANG[currentLang].postPublished,t.classList.remove("error-message"),t.classList.add("success-message"),e.value=""):(t.textContent="Failed to publish post.",t.classList.remove("success-message"),t.classList.add("error-message"))}function loadFriendsList(){const e=$("myFriendsList");e.innerHTML="",currentUser&&currentUser.friends&&currentUser.friends.length>0?currentUser.friends.forEach((t=>{const n=document.createElement("li");n.innerHTML=`<span>${sanitize(t)}</span><button data-username="${sanitize(t)}" class="remove-friend-btn">X</button>`,n.querySelector(".remove-friend-btn").addEventListener("click",handleRemoveFriend),e.appendChild(n)})):e.innerHTML=`<p>${LANG[currentLang].noFriendsYet}</p>`}function handleFriendSearch(){const e=$("friendSearchInput").value.toLowerCase(),t=$("friendSearchResults");if(t.innerHTML="",e.length<2)return void(t.innerHTML="");const n=users.filter((t=>t.username.toLowerCase().includes(e)&&t.username!==(currentUser?currentUser.username:"")));0!==n.length?n.forEach((e=>{const n=document.createElement("div");n.classList.add("user-card"),n.innerHTML=`<span>${sanitize(e.username)}</span>`;const a=document.createElement("button");a.textContent=LANG[currentLang].addFriend,a.dataset.username=e.username,currentUser&&currentUser.friends&&currentUser.friends.includes(e.username)?(a.textContent=LANG[currentLang].alreadyFriends,a.disabled=!0):currentUser&&currentUser.username===e.username?(a.textContent=LANG[currentLang].cannotAddSelf,a.disabled=!0):a.addEventListener("click",handleAddFriend),n.appendChild(a),t.appendChild(n)})):t.innerHTML=`<p>${LANG[currentLang].noSearchResults}</p>`}async function handleAddFriend(e){if(!currentUser)return void alert("You must be logged in to add friends.");const t=e.target.dataset.username;currentUser.username!==t?currentUser.friends.includes(t)||(currentUser.friends.push(t),await saveUserToLocalStorage(currentUser),loadFriendsList(),alert(LANG[currentLang].friendAdded.replace("{username}",t)),handleFriendSearch()):alert(LANG[currentLang].cannotAddSelf)}async function handleRemoveFriend(e){if(!currentUser)return void alert("You must be logged in to remove friends.");const t=e.target.dataset.username;currentUser.friends=currentUser.friends.filter((e=>e!==t)),await saveUserToLocalStorage(currentUser),loadFriendsList(),alert(`Friend ${t} removed.`)}let currentBuildingGame=null;function loadMyGames(){const e=$("myGamesList");e.innerHTML="",currentUser&&currentUser.games&&0!==currentUser.games.length?currentUser.games.forEach((t=>{const n=document.createElement("div");n.classList.add("game-card"),n.innerHTML=`\n                <h4>${sanitize(t.name)}</h4>\n                <p>Type: ${sanitize(t.type)}</p>\n                <p>Published: ${t.isPublished?"Yes":"No"}</p>\n                <div class="game-card-actions">\n                    <button class="build-game-btn" data-game-id="${t.id}">${LANG[currentLang].build}</button>\n                    <button class="play-game-btn" data-game-id="${t.id}" ${t.isPublished?"":"disabled"}>${LANG[currentLang].games}</button>\n                </div>\n            `,n.querySelector(".build-game-btn").addEventListener("click",(()=>startBuildingGame(t.id))),n.querySelector(".play-game-btn").addEventListener("click",(()=>playGame(t.id))),e.appendChild(n)})):e.innerHTML=`<p>${LANG[currentLang].noGamesYet}</p>`}function loadPublishedGames(){const e=$("publishedGamesList");e.innerHTML="";const t=games.filter((e=>e.isPublished));0!==t.length?t.forEach((t=>{const n=document.createElement("div");n.classList.add("game-card"),n.innerHTML=`\n                <h4>${sanitize(t.name)}</h4>\n                <p>Type: ${sanitize(t.type)}</p>\n                <p>Creator: ${sanitize(t.creatorUsername||"Unknown")}</p>\n                <div class="game-card-actions">\n                    <button class="play-game-btn" data-game-id="${t.id}">${LANG[currentLang].games}</button>\n                </div>\n            `,n.querySelector(".play-game-btn").addEventListener("click",(()=>playGame(t.id))),e.appendChild(n)})):e.innerHTML=`<p>${LANG[currentLang].noPublishedGames}</p>`}async function buildNewGame(){if(!currentUser)return void alert("You must be logged in to build a new game.");const e=prompt(LANG[currentLang].gameNamePrompt);if(!e||""===e.trim())return;const t=prompt(`${LANG[currentLang].selectGameType}\n${LANG[currentLang].baseTemple}, ${LANG[currentLang].parkour}, ${LANG[currentLang].island}`);if(!t||""===t.trim())return;const n=`game-${Date.now()}`,a={id:n,name:sanitize(e),type:sanitize(t),creatorId:window.getCurrentUserId(),creatorUsername:currentUser.username,isPublished:!1,data:{}};currentUser.games||(currentUser.games=[]),currentUser.games.push(a),await saveUserToLocalStorage(currentUser),games.push(a),localStorage.setItem("pokregamGames",JSON.stringify(games)),startBuildingGame(n)}function startBuildingGame(e){if(currentBuildingGame=games.find((t=>t.id===e)),currentBuildingGame){$("currentBuildingGameName").textContent=sanitize(currentBuildingGame.name),switchTab("gameBuilderTab");const e=$("gameCanvas"),t=e.getContext("2d");e.width=600,e.height=400,t.fillStyle="#ADD8E6",t.fillRect(0,0,e.width,e.height),t.fillStyle="#333",t.font="20px Arial",t.fillText(`Building: ${currentBuildingGame.name}`,50,200),$("gameBuilderMessage").textContent=""}else alert("Game not found for building.")}async function publishCurrentGame(){if(!currentBuildingGame)return void alert("No game selected for publishing.");currentBuildingGame.isPublished=!0;const e=games.findIndex((e=>e.id===currentBuildingGame.id));-1!==e&&(games[e]=currentBuildingGame,localStorage.setItem("pokregamGames",JSON.stringify(games)));const t=currentUser.games.findIndex((e=>e.id===currentBuildingGame.id));-1!==t&&(currentUser.games[t]=currentBuildingGame,await saveUserToLocalStorage(currentUser)),$("gameBuilderMessage").textContent=LANG[currentLang].gamePublishedSuccess.replace("{gameName}",currentBuildingGame.name),$("gameBuilderMessage").classList.remove("error-message"),$("gameBuilderMessage").classList.add("success-message"),loadMyGames(),loadPublishedGames()}function playGame(e){const t=games.find((t=>t.id===e));if(!t)return void alert("Game not found.");if(!t.isPublished&&t.creatorId!==window.getCurrentUserId())return void alert(LANG[currentLang].gameNotPublished);$("playingGameName").textContent=sanitize(t.name),switchTab("playGameSection");const n=$("playGameCanvas"),a=n.getContext("2d");n.width=600,n.height=400,a.fillStyle="#ADD8E6",a.fillRect(0,0,n.width,n.height),a.fillStyle="#333",a.font="24px Arial",a.fillText(`Playing: ${t.name}`,50,150),a.font="16px Arial",a.fillText(`Type: ${t.type}`,50,180),a.fillText(`Creator: ${t.creatorUsername}`,50,200)}let reportTargetUsername="";function openReportModal(e){reportTargetUsername=e,$("reportUsernameTarget").textContent=sanitize(e),$("reportMessage").textContent="",document.querySelectorAll('input[name="reportReason"]').forEach((e=>e.checked=!1)),$("reportComment").value="",show($("reportUserModal"))}function closeReportModal(){hide($("reportUserModal")),reportTargetUsername=""}async function handleReportSubmit(e){e.preventDefault();const t=document.querySelector('input[name="reportReason"]:checked'),n=$("reportComment").value.trim(),a=$("reportMessage");return t?currentUser&&currentUser.username!==reportTargetUsername?(console.log(`Report from ${currentUser.username} about ${reportTargetUsername}:`),console.log(`Reason: ${t.value}`),console.log(`Comment: ${n}`),a.textContent=LANG[currentLang].reportSuccess,a.classList.remove("error-message"),a.classList.add("success-message"),void setTimeout(closeReportModal,2e3)):(a.textContent=LANG[currentLang].reportCannotReportSelf,a.classList.remove("success-message"),void a.classList.add("error-message")):(a.textContent=LANG[currentLang].reportNoReason,a.classList.remove("success-message"),void a.classList.add("error-message"))}function renderAllChats(){const e=$("chatsContent");e.innerHTML="",allChats.forEach((t=>{const n=document.createElement("div");n.classList.add("chat-container");const a=document.createElement("div");a.classList.add("chat-header"),"private"===t.type?a.textContent=`Private Chat: ${sanitize(t.participants.join(", "))}`:"game"===t.type&&(a.textContent=`Game Chat: ${sanitize(t.game)}`),n.appendChild(a),t.messages.forEach((e=>{const t=document.createElement("div");t.classList.add("chat-message"),t.innerHTML=`<strong>${sanitize(e.sender)}:</strong> ${sanitize(e.text)} <span style="color:#777; font-size:0.8em;">(${e.time})</span>`,n.appendChild(t)})),e.appendChild(n)}))}document.addEventListener("DOMContentLoaded",(()=>{renderAvatars();const e=localStorage.getItem("pokregamLang");e&&(currentLang=e,$("languageSelector").value=e),translateUI(currentLang);const t=localStorage.getItem("currentUser");t?(currentUser=JSON.parse(t),showSection($("profileSection"))):showSection($("loginSection")),$("navGames").addEventListener("click",(()=>{currentUser?switchTab("gamesTab"):showSection($("loginSection"))})),$("navMarketplace").addEventListener("click",(()=>{currentUser?switchTab("marketplaceTab"):showSection($("loginSection"))})),$("navBuild").addEventListener("click",(()=>{currentUser?switchTab("buildTab"):showSection($("loginSection"))})),$("navNews").addEventListener("click",(()=>{currentUser?switchTab("newsTab"):showSection($("loginSection"))})),$("navRanking").addEventListener("click",(()=>{currentUser?switchTab("rankingTab"):showSection($("loginSection"))})),$("btnLogin").addEventListener("click",(()=>showSection($("loginSection")))),$("btnSignUp").addEventListener("click",(()=>showSection($("signUpSection")))),$("languageSelector").addEventListener("change",(e=>translateUI(e.target.value))),$("loginForm").addEventListener("submit",handleLogin),$("signUpForm").addEventListener("submit",handleSignUp),$("forgotPasswordForm").addEventListener("submit",handleForgotPassword),$("toSignUp").addEventListener("click",(()=>showSection($("signUpSection")))),$("toLogin").addEventListener("click",(()=>showSection($("loginSection")))),$("forgotPasswordLink").addEventListener("click",(()=>showSection($("forgotPasswordSection")))),$("backToLoginFromForgot").addEventListener("click",(()=>showSection($("loginSection")))),document.querySelectorAll("#tabs button[data-tab]").forEach((e=>{e.addEventListener("click",(()=>switchTab(e.dataset.tab)))})),$("btnLogout").addEventListener("click",handleLogout),document.querySelectorAll("#rankingTypeButtons button").forEach((e=>{e.addEventListener("click",(()=>{document.querySelectorAll("#rankingTypeButtons button").forEach((e=>e.classList.remove("active"))),e.classList.add("active"),updateRanking(e.dataset.rankingType)}))})),$("publishPostBtn").addEventListener("click",publishPost),$("searchFriendBtn").addEventListener("click",handleFriendSearch),$("friendSearchInput").addEventListener("input",handleFriendSearch),$("reportUserModal").querySelector(".close-button").addEventListener("click",closeReportModal),$("reportForm").addEventListener("submit",handleReportSubmit),$("buildNewGameBtn").addEventListener("click",buildNewGame),$("takeScreenshotBtn").addEventListener("click",(()=>alert("Screenshot taken! (Simulated)"))),$("publishGameBtn").addEventListener("click",publishCurrentGame),$("backToGamesListBtn").addEventListener("click",(()=>switchTab("gamesTab"))),$("returnToGamesListBtn").addEventListener("click",(()=>switchTab("gamesTab"))),currentUser&&"guest"===currentUser.username&&"Freeaccount"===currentUser.password?(showSection($("allChatsSection")),renderAllChats()):hide($("allChatsSection"))}))</script>
</body>
</html>
