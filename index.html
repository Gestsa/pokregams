<!doctype html>
<html lang=en>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<!doctype html>
<html lang=en>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>PoKreGaM</title>
<style>body{font-family:Arial,sans-serif;margin:0;padding:0;background-color:#f4f4f4;color:#333;display:flex;flex-direction:column;min-height:100vh}header{background-color:#333;color:#fff;padding:10px 20px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 5px rgba(0,0,0,.2);flex-wrap:wrap}header h1{margin:0;font-size:1.8em}.header-controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}.header-controls button,.header-controls select{padding:8px 15px;border:none;border-radius:5px;cursor:pointer;background-color:#555;color:#fff;transition:background-color .2s;white-space:nowrap}.header-controls button:hover,.header-controls select:hover{background-color:#777}main{flex-grow:1;padding:20px;display:flex;justify-content:center;align-items:flex-start}section{background-color:#fff;padding:20px 30px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.1);width:100%;max-width:600px;box-sizing:border-box;margin-bottom:20px}section.hidden{display:none}h2{color:#444;text-align:center;margin-bottom:20px}form{display:flex;flex-direction:column;gap:15px}form label{font-weight:700;margin-bottom:5px;display:block}form input[type=date],form input[type=email],form input[type=password],form input[type=text],form select,form textarea{width:calc(100% - 20px);padding:10px;border:1px solid #ccc;border-radius:5px;font-size:1em;margin-top:5px;box-sizing:border-box}form button{padding:10px 20px;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:1.1em;transition:background-color .2s}form button:hover{background-color:#0056b3}.error-message{color:#dc3545;margin-top:10px;text-align:center;font-weight:700}.success-message{color:#28a745;margin-top:10px;text-align:center;font-weight:700}.link-text{text-align:center;margin-top:15px}.link-text a,.link-text button{color:#007bff;text-decoration:none;cursor:pointer;background:0 0;border:none;padding:0;font-size:1em;transition:color .2s}.link-text a:hover,.link-text button:hover{color:#0056b3}#avatarsContainer{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:10px;margin-bottom:20px;justify-items:center}.avatar{border:2px solid transparent;border-radius:8px;padding:5px;cursor:pointer;text-align:center;transition:border-color .2s,background-color .2s}.avatar img{width:80px;height:80px;border-radius:50%;object-fit:cover;display:block;margin:0 auto 5px}.avatar.selected{border-color:#007bff;background-color:#e0f0ff}#profileSection{display:flex;flex-direction:column;width:100%;max-width:900px}#profileHeader{display:flex;align-items:center;gap:20px;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid #eee;flex-wrap:wrap;justify-content:center;text-align:center}#profileAvatar img{width:100px;height:100px;border-radius:50%;object-fit:cover;border:3px solid #007bff}#profileInfo{flex-grow:1}#profileInfo p{margin:5px 0;font-size:1.1em}#profileInfo p strong{color:#007bff}#profileInfo span{font-weight:400}#profileStats{display:flex;flex-wrap:wrap;gap:15px;margin-top:10px;justify-content:center}#profileStats div{background-color:#e9f5ff;padding:8px 12px;border-radius:5px;font-size:.9em;color:#0056b3;font-weight:700}#tabs{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:20px;border-bottom:2px solid #eee;padding-bottom:5px;justify-content:center}#tabs button{background-color:#f0f0f0;color:#555;padding:10px 15px;border:1px solid #ddd;border-bottom:none;border-radius:8px 8px 0 0;cursor:pointer;font-weight:700;transition:background-color .2s,color .2s,border-color .2s;white-space:nowrap}#tabs button.active{background-color:#fff;color:#007bff;border-color:#007bff;border-bottom:2px solid #fff;position:relative;z-index:1}.tabContent{background-color:#fff;padding:20px;border-radius:0 0 8px 8px;box-shadow:0 2px 10px rgba(0,0,0,.05)}#rankingTab h3{text-align:center;margin-bottom:15px}#rankingTypeButtons{text-align:center;margin-bottom:20px;display:flex;flex-wrap:wrap;justify-content:center;gap:10px}#rankingTypeButtons button{padding:8px 15px;border:1px solid #007bff;border-radius:5px;background-color:#fff;color:#007bff;cursor:pointer;transition:all .2s}#rankingTypeButtons button.active{background-color:#007bff;color:#fff}#rankingTable{width:100%;border-collapse:collapse;margin-top:15px}#rankingTable td,#rankingTable th{border:1px solid #ddd;padding:10px 12px;text-align:left;word-break:break-word}#rankingTable th{background-color:#f2f2f2;font-weight:700;color:#555}#rankingTable tbody tr:nth-child(2n){background-color:#f9f9f9}#rankingTable tbody tr:hover{background-color:#e0f7fa}#rankingTable td button.report-user-btn{background-color:#ffc107;color:#333;border:none;padding:4px 8px;border-radius:4px;cursor:pointer;font-size:.8em;margin-left:10px;transition:background-color .2s;white-space:nowrap}#rankingTable td button.report-user-btn:hover{background-color:#e0a800}#writePostSection{margin-bottom:30px;padding-bottom:20px;border-bottom:1px solid #eee}#postContent{resize:vertical;min-height:80px;margin-bottom:10px}#publishPostBtn{width:auto;align-self:flex-end;margin-top:5px}.post{border:1px solid #eee;border-radius:8px;padding:15px;margin-bottom:15px;background-color:#fefefe;box-shadow:0 1px 3px rgba(0,0,0,.05)}.post-header{display:flex;align-items:center;margin-bottom:10px}.post-avatar img{width:40px;height:40px;border-radius:50%;margin-right:10px;object-fit:cover}.post-info{flex-grow:1}.post-author{font-weight:700;color:#007bff}.post-time{font-size:.8em;color:#777}.post-content{line-height:1.5;white-space:pre-wrap;word-wrap:break-word}#allChatsSection{text-align:center}#chatsContent{margin-top:20px;border-top:1px solid #eee;padding-top:20px;max-height:400px;overflow-y:auto}.chat-container{border:1px solid #e0e0e0;border-radius:8px;padding:15px;margin-bottom:15px;background-color:#fff;box-shadow:0 1px 4px rgba(0,0,0,.08)}.chat-header{font-weight:700;margin-bottom:10px;color:#0056b3;border-bottom:1px dashed #cce;padding-bottom:5px}.chat-message{margin-bottom:5px;font-size:.9em;color:#444}.friends-search{display:flex;gap:10px;margin-bottom:20px}.friends-search input{flex-grow:1;min-width:100px}.friends-search button{flex-shrink:0;width:auto;padding:10px 20px}.user-list{max-height:300px;overflow-y:auto;border:1px solid #eee;padding:10px;border-radius:5px;margin-bottom:20px}.user-card{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-bottom:1px solid #f5f5f5}.user-card:last-child{border-bottom:none}.user-card span{font-weight:700;color:#333}.user-card button{background-color:#28a745;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:.9em;transition:background-color .2s;width:auto}.user-card button:hover:not(:disabled){background-color:#218838}.user-card button:disabled{background-color:#ccc;cursor:not-allowed}.my-friends ul{list-style:none;padding:0}.my-friends li{background-color:#e9f5ff;padding:8px 12px;border-radius:5px;margin-bottom:5px;display:flex;justify-content:space-between;align-items:center}.my-friends li:last-child{margin-bottom:0}.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.4);display:flex;align-items:center;justify-content:center}.modal.hidden{display:none}.modal-content{background-color:#fefefe;margin:auto;padding:20px;border:1px solid #888;border-radius:8px;width:90%;max-width:500px;position:relative;box-shadow:0 4px 8px rgba(0,0,0,.2);animation-name:animatetop;animation-duration:.4s}@-webkit-keyframes animatetop{from{top:-300px;opacity:0}to{top:0;opacity:1}}@keyframes animatetop{from{top:-300px;opacity:0}to{top:0;opacity:1}}.close-button{color:#aaa;float:right;font-size:28px;font-weight:700;position:absolute;right:15px;top:10px;cursor:pointer}.close-button:focus,.close-button:hover{color:#000;text-decoration:none;cursor:pointer}.modal-content h2{margin-top:0;margin-bottom:15px;color:#333;font-size:1.5em}.modal-content form label{display:flex;align-items:center;gap:10px;margin-bottom:8px;font-weight:400}.modal-content form input[type=radio]{margin-right:5px;width:auto}.modal-content form textarea{width:calc(100% - 22px);min-height:80px;margin-top:10px;box-sizing:border-box}.modal-content form button{width:auto;margin-top:15px;align-self:center;padding:10px 25px}@media (max-width:768px){header{flex-direction:column;gap:10px}header h1{font-size:1.5em}main{padding:10px}section{padding:15px}#profileHeader{flex-direction:column;text-align:center;gap:10px}#profileStats{justify-content:center}#tabs{flex-direction:column;align-items:center}#tabs button{width:90%;border-radius:8px;border-bottom:1px solid #ddd}#tabs button.active{border-bottom:1px solid #007bff}}</style>
</head>
<body>
<header>
<h1>PoKreGaM</h1>
<div class=header-controls>
<nav id=navMain>
<button id=navGames>Games</button>
<button id=navMarketplace>Marketplace</button>
<button id=navBuild>Build</button>
<button id=navNews>News</button>
<button id=navRanking>Ranking</button>
</nav>
<select id=languageSelector>
<option value=en>English</option>
<option value=pl>Polski</option>
<option value=mk>Македонски</option>
</select>
<button id=btnLogin>Login</button>
<button id=btnSignUp>Sign Up</button>
</div>
</header>
<main>
<section id=loginSection class=hidden>
<h2 id=loginTitle>Login</h2>
<form id=loginForm>
<label for=loginUsername>Username:</label>
<input id=loginUsername required>
<label for=loginPassword>Password:</label>
<input type=password id=loginPassword required>
<button type=submit id=loginSubmit>Login</button>
<p id=loginError class=error-message></p>
<p class=link-text><button type=button id=forgotPasswordLink>Forgot Password?</button></p>
<p class=link-text><button type=button id=toSignUp>Don't have an account? Sign Up</button></p>
</form>
</section>
<section id=signUpSection class=hidden>
<h2 id=signUpTitle>Sign Up</h2>
<form id=signUpForm>
<p id=selectCharacter>Select your character:</p>
<div id=avatarsContainer>
</div>
<label for=signUpUsername>Username:</label>
<input id=signUpUsername required>
<label for=signUpEmail>Email (optional):</label>
<input type=email id=signUpEmail>
<label for=signUpCountry>Country:</label>
<select id=signUpCountry required>
<option value=PL>Poland</option>
<option value=US>United States</option>
<option value=MK>North Macedonia</option>
</select>
<label for=signUpPassword>Password:</label>
<input type=password id=signUpPassword required>
<label for=signUpBirthdate>Birthdate:</label>
<input type=date id=signUpBirthdate required>
<button type=submit id=signUpSubmit>Sign Up</button>
<p id=signUpError class=error-message></p>
<p class=link-text><button type=button id=toLogin>Already have an account? Login</button></p>
</form>
</section>
<section id=forgotPasswordSection class=hidden>
<h2 id=forgotPasswordTitle>Forgot Password</h2>
<p id=forgotPasswordInstructions>Please enter your email. If an account is associated with it, we will send you your account details (username and password) via email.</p>
<form id=forgotPasswordForm>
<label for=forgotPasswordEmail>Email:</label>
<input type=email id=forgotPasswordEmail required>
<button type=submit id=sendRecoveryEmail>Send Recovery Email</button>
<p id=forgotPasswordMessage class=success-message></p>
<p id=forgotPasswordError class=error-message></p>
<p class=link-text><button type=button id=backToLoginFromForgot>Back to Login</button></p>
</form>
</section>
<section id=profileSection class=hidden>
<div id=profileHeader>
<div id=profileAvatar>
<img src="" alt="User Avatar">
</div>
<div id=profileInfo>
<p><strong id=profileUsernameLabel>Username:</strong> <span id=profileUsername></span></p>
<p><strong id=profileCountryLabel>Country:</strong> <span id=profileCountry></span></p>
<p><strong id=profileRankingPlaceLabel>XP Ranking Place:</strong> <span id=profileRankingPlace></span></p>
<div id=profileStats>
<div id=profileXPLabel>XP: <span id=profileXP>0</span></div>
<div id=profileLevelLabel>Level: <span id=profileLevel>1</span></div>
<div id=profileFriendsCountLabel>Friends: <span id=profileFriendsCount>0</span></div>
<div id=profileGoldLabel>Gold: <span id=profileGold>0</span></div>
</div>
</div>
</div>
<nav id=tabs>
<button data-tab=gamesTab class=active aria-selected=true id=gamesTabButton>Games</button>
<button data-tab=marketplaceTab aria-selected=false id=marketplaceTabButton>Marketplace</button>
<button data-tab=buildTab aria-selected=false id=buildTabButton>Build</button>
<button data-tab=newGameTab aria-selected=false id=newGameTabButton>New Game</button>
<button data-tab=newsTab aria-selected=false id=newsTabButton>News</button>
<button data-tab=rankingTab aria-selected=false id=rankingTabButton>Ranking</button>
<button data-tab=postsTab aria-selected=false id=postsTabButton>Posts</button>
<button data-tab=friendsTab aria-selected=false id=friendsTabButton>Friends</button> <button id=checkThisBtn class=hidden>Check this</button>
<button id=btnLogout>Logout</button>
</nav>
<div id=tabContents>
<div id=gamesTab class="tabContent active">
<h3 id=gamesTabTitle>Games</h3>
<p id=gamesWelcomeText>Welcome to your games! Start a new adventure or continue an existing one.</p>
<button id=startGameBtn>Start New Game</button>
</div>
<div id=marketplaceTab class="tabContent hidden">
<h3 id=marketplaceTabTitle>Marketplace</h3>
<p id=marketplaceDescription>Buy and sell items, weapons, and armor here.</p>
</div>
<div id=buildTab class="tabContent hidden">
<h3 id=buildTabTitle>Build</h3>
<p id=buildDescription>Craft new items or build your base.</p>
</div>
<div id=newGameTab class="tabContent hidden">
<h3 id=newGameTabTitle>New Game</h3>
<p id=newGameDescription>Choose your game type and begin a new journey.</p>
</div>
<div id=newsTab class="tabContent hidden">
<h3 id=newsTabTitle>News</h3>
<p id=newsDescription>Stay updated with the latest game news and community announcements.</p>
<p>No news articles available at the moment. Check back soon!</p>
</div>
<div id=rankingTab class="tabContent hidden">
<h3 id=rankingTabTitle>XP Ranking</h3>
<div id=rankingTypeButtons>
<button data-ranking-type=overall class=active id=overallRankingBtn>Overall Ranking</button>
<button data-ranking-type=weekly id=weeklyRankingBtn>Weekly Ranking</button>
<button data-ranking-type=monthly id=monthlyRankingBtn>Monthly Ranking</button>
<button data-ranking-type=yearly id=yearlyRankingBtn>Yearly Ranking</button>
<button data-ranking-type=global id=globalRankingBtn>Global Ranking (by country)</button>
</div>
<table id=rankingTable>
<thead>
<tr>
<th>Place</th>
<th>Username</th>
<th>XP</th>
<th>Level</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<div id=postsTab class="tabContent hidden">
<h3 id=postsTabTitle>Community Posts</h3>
<div id=writePostSection>
<label for=postContent id=writePostLabel>Write your post:</label>
<textarea id=postContent placeholder="What's on your mind?"></textarea>
<button id=publishPostBtn>Publish</button>
<p id=postMessage class=success-message></p>
</div>
<div id=communityPosts>
</div>
</div>
<div id=friendsTab class="tabContent hidden">
<h3 id=friendsTabTitle>Friends</h3>
<div class=friends-search>
<input id=friendSearchInput placeholder="Wyszukaj użytkownika...">
<button id=searchFriendBtn>Szukaj</button>
</div>
<div id=friendSearchResults class=user-list>
</div>
<div class=my-friends>
<h3 id=myFriendsListTitle>Moi Przyjaciele</h3>
<ul id=myFriendsList>
</ul>
</div>
</div>
</div>
</section>
<section id=allChatsSection class=hidden>
<h2 id=allChatsTitle>All Private and Game Chats (Guest Access)</h2>
<p id=allChatsDescription>This content is only visible to 'guest' users logged in with password 'Freeaccount'.</p>
<div id=chatsContent>
</div>
</section>
</main>
<div id=reportUserModal class="modal hidden">
<div class=modal-content>
<span class=close-button>&times;</span>
<h2 id=reportUserModalHeader>Zgłoś Użytkownika: <span id=reportUsernameTarget></span></h2>
<p id=reportReasonLabel>Wybierz powód zgłoszenia:</p>
<form id=reportForm>
<label>
<input type=radio name=reportReason value=sexualContent> <span id=sexualContentReason>Seksualna treść</span>
</label><br>
<label>
<input type=radio name=reportReason value=hateSpeech> <span id=hateSpeechReason>Mowa nienawiści / Brzydkie słowa</span>
</label><br>
<label>
<input type=radio name=reportReason value=personalData> <span id=personalDataReason>Udostępnianie danych osobowych</span>
</label><br>
<label>
<input type=radio name=reportReason value=maliciousLink> <span id=maliciousLinkReason>Wysyłanie nieznanych/złośliwych linków</span>
</label><br>
<label>
<input type=radio name=reportReason value=threats> <span id=threatsReason>Grożenie</span>
</label><br>
<label>
<input type=radio name=reportReason value=cheating> <span id=cheatingReason>Cheaty</span>
</label><br>
<label>
<input type=radio name=reportReason value=adminImpersonation> <span id=adminImpersonationReason>Podawanie się za admina</span>
</label><br>
<label>
<input type=radio name=reportReason value=passwordSharing> <span id=passwordSharingReason>Udostępnianie cudzego hasła</span>
</label><br>
<label>
<input type=radio name=reportReason value=other> <span id=otherReason>Inne</span> (opcjonalnie doprecyzuj poniżej)
</label><br>
<textarea id=reportComment placeholder="Dodatkowe uwagi (opcjonalnie)"></textarea><br>
<button type=submit id=sendReportBtn>Wyślij Zgłoszenie</button>
<p id=reportMessage class=error-message></p>
</form>
</div>
</div>
<script>const LANG={en:{login:"Login",signup:"Sign Up",username:"Username",password:"Password",email:"Email (optional)",country:"Country",birthdate:"Birthdate",selectCharacter:"Select your character:",dontHaveAccount:"Don't have an account? Sign Up",alreadyHaveAccount:"Already have an account? Login",rankingXPPlace:"XP Ranking Place:",games:"Games",marketplace:"Marketplace",build:"Build",newGame:"New Game",news:"News",ranking:"Ranking",posts:"Posts",startNewGame:"Start New Game",loginError:"Incorrect username or password.",signUpError:"Please fill in all required fields and select a character.",logout:"Logout",checkThis:"Check this",allChatsTitle:"All Private and Game Chats (Guest Access)",allChatsDescription:"This content is only visible to 'guest' users logged in with password 'Freeaccount'.",forgotPassword:"Forgot Password?",forgotPasswordTitle:"Forgot Password",forgotPasswordInstructions:"Please enter your email. If an account is associated with it, we will send you your account details (username and password) via email.",sendRecoveryEmail:"Send Recovery Email",backToLogin:"Back to Login",recoveryEmailSent:"If an account exists with this email, your account details (username: {username}, password: {password}) have been sent to your email. (Simulation)",recoveryEmailNotFound:"No account found with that email or no email provided for the account. Please check your email or try signing up.",postsTabTitle:"Community Posts",writePostLabel:"Write your post:",publishPostBtn:"Publish",postContentPlaceholder:"What's on your mind?",postPublished:"Post successfully published!",postEmpty:"Post cannot be empty.",overallRanking:"Overall Ranking",weeklyRanking:"Weekly Ranking",monthlyRanking:"Monthly Ranking",yearlyRanking:"Yearly Ranking",globalRankingCountry:"Global Ranking (by country)",rankingTabTitle:"XP Ranking",friends:"Friends",search:"Search",myFriends:"My Friends",noSearchResults:"No search results found.",addFriend:"Add Friend",alreadyFriends:"Already Friends",cannotAddSelf:"Cannot add yourself as a friend.",friendAdded:"User {username} has been added to your friends list.",noFriendsYet:"You don't have any friends yet.",reportUser:"Report",reportUserModalTitle:"Report User:",reportReason:"Select report reason:",sexualContent:"Sexual content",hateSpeech:"Hate speech / Bad language",personalData:"Sharing personal data",maliciousLink:"Sending unknown/malicious links",threats:"Threats",cheating:"Cheating",adminImpersonation:"Impersonating an admin",passwordSharing:"Sharing someone else's password",other:"Other",additionalComments:"Additional comments (optional)",sendReport:"Send Report",reportSuccess:"Report submitted successfully. Thank you!",reportNoReason:"Please select a report reason.",reportCannotReportSelf:"You cannot report yourself.",noPostsYet:"No posts yet. Be the first to share something!",noNewsYet:"No news articles available at the moment. Check back soon!"},pl:{login:"Zaloguj się",signup:"Zarejestruj się",username:"Nazwa użytkownika",password:"Hasło",email:"E-mail (opcjonalnie)",country:"Kraj",birthdate:"Data urodzenia",selectCharacter:"Wybierz swoją postać:",dontHaveAccount:"Nie masz konta? Zarejestruj się",alreadyHaveAccount:"Masz już konto? Zaloguj się",rankingXPPlace:"Miejsce w rankingu XP:",games:"Gry",marketplace:"Rynek",build:"Buduj",newGame:"Nowa gra",news:"Aktualności",ranking:"Ranking",posts:"Posty",startNewGame:"Rozpocznij nową grę",loginError:"Nieprawidłowa nazwa użytkownika lub hasło.",signUpError:"Proszę wypełnić wszystkie wymagane pola i wybrać postać.",logout:"Wyloguj się",checkThis:"Sprawdź to",allChatsTitle:"Wszystkie prywatne czaty i czaty z gier (Dostęp gościa)",allChatsDescription:"Ta zawartość jest widoczna tylko dla użytkowników 'gość' zalogowanych hasłem 'Freeaccount'.",forgotPassword:"Zapomniałeś hasła?",forgotPasswordTitle:"Zapomniałeś hasła",forgotPasswordInstructions:"Proszę podać swój adres e-mail. Jeśli istnieje konto z nim powiązane, wyślemy Ci dane konta (nazwa użytkownika i hasło) e-mailem.",sendRecoveryEmail:"Wyślij e-mail odzyskiwania",backToLogin:"Wróć do logowania",recoveryEmailSent:"Jeśli istnieje konto z tym adresem e-mail, dane Twojego konta (nazwa użytkownika: {username}, hasło: {password}) zostały wysłane na Twój adres e-mail. (Symulacja)",recoveryEmailNotFound:"Nie znaleziono konta z tym adresem e-mail lub nie podano adresu e-mail dla konta. Sprawdź swój adres e-mail lub spróbuj się zarejestrować.",postsTabTitle:"Posty społeczności",writePostLabel:"Napisz swoją wiadomość:",publishPostBtn:"Opublikuj",postContentPlaceholder:"Co masz na myśli?",postPublished:"Post został pomyślnie opublikowany!",postEmpty:"Wiadomość nie może być pusta.",overallRanking:"Ogólny ranking",weeklyRanking:"Ranking tygodniowy",monthlyRanking:"Ranking miesięczny",yearlyRanking:"Ranking roczny",globalRankingCountry:"Globalny ranking (według kraju)",rankingTabTitle:"Ranking XP",friends:"Znajomi",search:"Szukaj",myFriends:"Moi Przyjaciele",noSearchResults:"Brak wyników wyszukiwania.",addFriend:"Dodaj znajomego",alreadyFriends:"Jesteście już znajomymi",cannotAddSelf:"Nie możesz dodać samego siebie do znajomych.",friendAdded:"Użytkownik {username} został dodany do listy znajomych.",noFriendsYet:"Nie masz jeszcze znajomych.",reportUser:"Zgłoś",reportUserModalTitle:"Zgłoś Użytkownika:",reportReason:"Wybierz powód zgłoszenia:",sexualContent:"Treść seksualna",hateSpeech:"Mowa nienawiści / Wulgaryzmy",personalData:"Udostępnianie danych osobowych",maliciousLink:"Wysyłanie nieznanych/złośliwych linków",threats:"Groźby",cheating:"Oszustwa",adminImpersonation:"Podawanie się za administratora",passwordSharing:"Udostępnianie cudzego hasła",other:"Inne",additionalComments:"Dodatkowe uwagi (opcjonalnie)",sendReport:"Wyślij Zgłoszenie",reportSuccess:"Zgłoszenie zostało pomyślnie wysłane. Dziękujemy!",reportNoReason:"Proszę wybrać powód zgłoszenia.",reportCannotReportSelf:"Nie możesz zgłosić samego siebie.",noPostsYet:"Brak postów. Bądź pierwszy, który coś udostępni!",noNewsYet:"Brak dostępnych artykułów z wiadomościami. Sprawdź ponownie wkrótce!"},mk:{login:"Најава",signup:"Регистрација",username:"Корисничко име",password:"Лозинка",email:"Е-пошта (опционално)",country:"Држава",birthdate:"Датум на раѓање",selectCharacter:"Избери го својот карактер:",dontHaveAccount:"Немате сметка? Регистрирајте се",alreadyHaveAccount:"Веќе имате сметка? Најавете се",rankingXPPlace:"Место на ранг листата по XP:",games:"Игри",marketplace:"Пазар",build:"Изградба",newGame:"Нова игра",news:"Вести",ranking:"Ранг листа",posts:"Објави",startNewGame:"Започни нова игра",loginError:"Погрешно корисничко име или лозинка.",signUpError:"Ве молиме пополнете ги сите задолжителни полиња и изберете карактер.",logout:"Одјави се",checkThis:"Провери го ова",allChatsTitle:"Сите приватни разговори и разговори од игри (Гостински пристап)",allChatsDescription:"Оваа содржина е видлива само за 'гостин' корисници најавени со лозинката 'Freeaccount'.",forgotPassword:"Заборавена лозинка?",forgotPasswordTitle:"Заборавена лозинка",forgotPasswordInstructions:"Ве молиме внесете ја вашата е-пошта. Доколку постои сметка поврзана со неа, ќе ви ги испратиме деталите за вашата сметка (корисничко име и лозинка) по е-пошта.",sendRecoveryEmail:"Испрати е-пошта за обнова",backToLogin:"Назад на Најава",recoveryEmailSent:"Доколку постои сметка со оваа е-пошта, деталите за вашата сметка (корисничко име: {username}, лозинка: {password}) се испратени на вашата е-пошта. (Симулација)",recoveryEmailNotFound:"Не е пронајдена сметка со таа е-пошта или не е обезбедена е-попошта за сметката. Ве молиме проверете ја вашата е-пошта или обидете се да се регистрирате.",postsTabTitle:"Објави на заедницата",writePostLabel:"Напиши ја вашата објава:",publishPostBtn:"Објави",postContentPlaceholder:"Што ви е на ум?",postPublished:"Објавата е успешно објавена!",postEmpty:"Објавата не може да биде празна.",overallRanking:"Вкупна ранг листа",weeklyRanking:"Неделна ранг листа",monthlyRanking:"Месечна ранг листа",yearlyRanking:"Годишна ранг листа",globalRankingCountry:"Глобална ранг листа (по држава)",rankingTabTitle:"XP Ранг листа",friends:"Пријатели",search:"Барај",myFriends:"Мои Пријатели",noSearchResults:"Нема резултати од пребарувањето.",addFriend:"Додај пријател",alreadyFriends:"Веќе пријатели",cannotAddSelf:"Не можете да се додадете себеси како пријател.",friendAdded:"Корисникот {username} е додаден во вашите пријатели.",noFriendsYet:"Сè уште немате пријатели.",reportUser:"Пријави",reportUserModalTitle:"Пријави Корисник:",reportReason:"Изберете причина за пријава:",sexualContent:"Сексуална содржина",hateSpeech:"Говор на омраза / Лош јазик",personalData:"Споделување лични податоци",maliciousLink:"Испраќање непознати/злонамерни линкови",threats:"Закани",cheating:"Мамење",adminImpersonation:"Претставување како администратор",passwordSharing:"Споделување туѓа лозинка",other:"Друго",additionalComments:"Дополнителни коментари (опционално)",sendReport:"Испрати Пријава",reportSuccess:"Пријавата е успешно поднесена. Благодариме!",reportNoReason:"Ве молиме изберете причина за пријава.",reportCannotReportSelf:"Не можете да се пријавите себеси.",noPostsYet:"Сè уште нема објави. Бидете првиот што ќе сподели нешто!",noNewsYet:"Во моментов нема достапни вести. Проверете наскоро!"}},avatars=[{id:"avatar1",name:"Smily Boy",src:"https://i.ibb.co/L8y2w5n/avatar1.jpg"},{id:"avatar2",name:"Warrior Girl",src:"https://i.ibb.co/qN9B21V/avatar2.jpg"},{id:"avatar3",name:"Zebra",src:"https://i.ibb.co/30B37fQ/avatar3.jpg"},{id:"avatar4",name:"King Of Water",src:"https://i.ibb.co/8Y4PqX4/avatar4.jpg"}],allChats=[{type:"private",participants:["UserA","UserB"],messages:[{sender:"UserA",text:"Hey, spotkałeś się z tą nową misją?",time:"10:05"},{sender:"UserB",text:"Tak, jest super trudna! Potrzebuję pomocy.",time:"10:07"},{sender:"UserA",text:"Jasne, mogę pomóc wieczorem.",time:"10:08"}]},{type:"game",game:"Dragon Slayer",messages:[{sender:"Player1",text:"Ktoś na raidzie o 20:00?",time:"11:15"},{sender:"Player2",text:"Ja będę!",time:"11:16"},{sender:"Player1",text:"Ok, zbieramy ekipę!",time:"11:17"}]},{type:"private",participants:["GraczX","GraczY"],messages:[{sender:"GraczX",text:"Widziałeś ten nowy item?",time:"12:01"},{sender:"GraczY",text:"O tak, jest niesamowity! Ale drogi...",time:"12:03"}]},{type:"game",game:"PoKreGaM Football",messages:[{sender:"Fanatik",text:"GOOOOOOL!!!",time:"13:30"},{sender:"Rywal",text:"Foul! To był faul!",time:"13:31"},{sender:"Fanatik",text:"Sędzia puścił, gramy dalej!",time:"13:32"}]},{type:"private",participants:["Admin","SupportUser"],messages:[{sender:"Admin",text:"Problem z serwerem rozwiązany.",time:"14:00"},{sender:"SupportUser",text:"Dzięki za szybką naprawę!",time:"14:01"}]}],$=e=>document.getElementById(e),show=e=>e.classList.remove("hidden"),hide=e=>e.classList.add("hidden"),sanitize=e=>String(e).replace(/[<>]/g,"");let currentLang="en";function translateUI(e){currentLang=e;const t=LANG[e];$("navGames").textContent=t.games,$("navMarketplace").textContent=t.marketplace,$("navBuild").textContent=t.build,$("navNews").textContent=t.news,$("navRanking").textContent=t.ranking,$("btnLogin").textContent=t.login,$("btnSignUp").textContent=t.signup,$("loginTitle").textContent=t.login,$("loginForm").querySelector('label[for="loginUsername"]').textContent=t.username+":",$("loginForm").querySelector('label[for="loginPassword"]').textContent=t.password+":",$("loginSubmit").textContent=t.login,$("loginError").textContent="",$("toSignUp").textContent=t.dontHaveAccount,$("forgotPasswordLink").textContent=t.forgotPassword,$("signUpTitle").textContent=t.signup,$("selectCharacter").textContent=t.selectCharacter,$("signUpForm").querySelector('label[for="signUpUsername"]').textContent=t.username+":",$("signUpForm").querySelector('label[for="signUpEmail"]').textContent=t.email+":",$("signUpForm").querySelector('label[for="signUpCountry"]').textContent=t.country+":",$("signUpForm").querySelector('label[for="signUpPassword"]').textContent=t.password+":",$("signUpForm").querySelector('label[for="signUpBirthdate"]').textContent=t.birthdate+":",$("signUpSubmit").textContent=t.signup,$("signUpError").textContent="",$("toLogin").textContent=t.alreadyHaveAccount,$("forgotPasswordTitle").textContent=t.forgotPasswordTitle,$("forgotPasswordInstructions").textContent=t.forgotPasswordInstructions,$("forgotPasswordForm").querySelector('label[for="forgotPasswordEmail"]').textContent=t.email+":",$("sendRecoveryEmail").textContent=t.sendRecoveryEmail,$("backToLoginFromForgot").textContent=t.backToLogin,$("forgotPasswordMessage").textContent="",$("forgotPasswordError").textContent="",$("profileUsernameLabel").textContent=t.username+":",$("profileCountryLabel").textContent=t.country+":",$("profileRankingPlaceLabel").textContent=t.rankingXPPlace+" ",$("profileXPLabel").childNodes[0].nodeValue="XP: ",$("profileLevelLabel").childNodes[0].nodeValue="Level: ",$("profileFriendsCountLabel").childNodes[0].nodeValue="Friends: ",$("profileGoldLabel").childNodes[0].nodeValue="Gold: ",$("gamesTabButton").textContent=t.games,$("marketplaceTabButton").textContent=t.marketplace,$("buildTabButton").textContent=t.build,$("newGameTabButton").textContent=t.newGame,$("newsTabButton").textContent=t.news,$("rankingTabButton").textContent=t.ranking,$("postsTabButton").textContent=t.posts,$("friendsTabButton").textContent=t.friends,$("btnLogout").textContent=t.logout,$("checkThisBtn").textContent=t.checkThis,$("gamesTabTitle").textContent=t.games,$("gamesWelcomeText").textContent=t.gamesWelcomeText||"Welcome to your games! Start a new adventure or continue an existing one.",$("startGameBtn").textContent=t.startNewGame,$("marketplaceTabTitle").textContent=t.marketplace,$("marketplaceDescription").textContent=t.marketplaceDescription||"Buy and sell items, weapons, and armor here.",$("buildTabTitle").textContent=t.build,$("buildDescription").textContent=t.buildDescription||"Craft new items or build your base.",$("newGameTabTitle").textContent=t.newGame,$("newGameDescription").textContent=t.newGameDescription||"Choose your game type and begin a new journey.",$("newsTabTitle").textContent=t.news,$("newsDescription").textContent=t.newsDescription||"Stay updated with the latest game news and community announcements.",$("newsTab").querySelector("p:last-child").textContent=t.noNewsYet,$("rankingTabTitle").textContent=t.ranking,$("overallRankingBtn").textContent=t.overallRanking,$("weeklyRankingBtn").textContent=t.weeklyRanking,$("monthlyRankingBtn").textContent=t.monthlyRanking,$("yearlyRankingBtn").textContent=t.yearlyRanking,$("globalRankingBtn").textContent=t.globalRankingCountry;const n=$("rankingTable").querySelectorAll("th");n[0].textContent="Place",n[1].textContent=t.username,n[2].textContent="XP",n[3].textContent="Level",$("postsTabTitle").textContent=t.postsTabTitle,$("writePostLabel").textContent=t.writePostLabel,$("postContent").placeholder=t.postContentPlaceholder,$("publishPostBtn").textContent=t.publishPostBtn,$("postMessage").textContent="",$("allChatsTitle").textContent=t.allChatsTitle,$("allChatsDescription").textContent=t.allChatsDescription,$("friendsTabTitle").textContent=t.friends,$("friendSearchInput").placeholder=t.search,$("searchFriendBtn").textContent=t.search,$("myFriendsListTitle").textContent=t.myFriends,$("reportUserModalHeader").childNodes[0].nodeValue=t.reportUserModalTitle+" ",$("reportReasonLabel").textContent=t.reportReason,$("sexualContentReason").textContent=t.sexualContent,$("hateSpeechReason").textContent=t.hateSpeech,$("personalDataReason").textContent=t.personalData,$("maliciousLinkReason").textContent=t.maliciousLink,$("threatsReason").textContent=t.threats,$("cheatingReason").textContent=t.cheating,$("adminImpersonationReason").textContent=t.adminImpersonation,$("passwordSharingReason").textContent=t.passwordSharing,$("otherReason").textContent=t.other,$("reportComment").placeholder=t.additionalComments,$("sendReportBtn").textContent=t.sendReport;const a=getCurrentUser();if(a&&$("profileSection").classList.contains("active")){renderProfile(a);const e=$("rankingTypeButtons").querySelector(".active");e&&renderRankingTable(e.dataset.rankingType),$("postsTab").classList.contains("active")&&renderPosts(),$("friendsTab").classList.contains("active")&&renderFriendsList(a)}}function renderAvatars(){const e=$("avatarsContainer");e.innerHTML="",avatars.forEach((t=>{const n=document.createElement("div");n.className="avatar",n.tabIndex=0,n.dataset.avatarId=t.id,n.title=t.name,n.innerHTML=`<img src="${t.src}" alt="${t.name}"/><br>${t.name}`,e.appendChild(n)}))}function getUsers(){let e=JSON.parse(localStorage.getItem("PoKreGaM_users")||"[]");const t={email:"",country:"PL",birthdate:"2000-01-01",avatarId:"avatar1",avatarName:"Smily Boy",gold:0,friends:[],xp:0,xpWeekly:0,xpMonthly:0,xpYearly:0,lastWeeklyReset:new Date(0).toISOString(),lastMonthlyReset:new Date(0).toISOString(),lastYearlyReset:new Date(0).toISOString(),posts:[]};let n=!1;if(e=e.map((e=>{const a={...t,...e};return void 0===a.xpWeekly&&(a.xpWeekly=0,n=!0),void 0===a.xpMonthly&&(a.xpMonthly=0,n=!0),void 0===a.xpYearly&&(a.xpYearly=0,n=!0),void 0===a.lastWeeklyReset&&(a.lastWeeklyReset=new Date(0).toISOString(),n=!0),void 0===a.lastMonthlyReset&&(a.lastMonthlyReset=new Date(0).toISOString(),n=!0),void 0===a.lastYearlyReset&&(a.lastYearlyReset=new Date(0).toISOString(),n=!0),void 0===a.friends&&(a.friends=[],n=!0),void 0===a.posts&&(a.posts=[],n=!0),void 0!==a.xpDaily&&(delete a.xpDaily,n=!0),void 0!==a.lastDailyReset&&(delete a.lastDailyReset,n=!0),a})),e.some((e=>"guest"===e.username))||(e.push({username:"guest",password:"Freeaccount",...t,avatarId:"avatar1",avatarName:"Smily Boy",xp:50,xpWeekly:10,xpMonthly:20,xpYearly:50,gold:5,friends:[]}),n=!0),e.some((e=>"testuser"===e.username))||(e.push({username:"testuser",email:"test@example.com",country:"US",password:"testpassword",birthdate:"1990-05-15",avatarId:"avatar2",avatarName:"Warrior Girl",xp:150,xpWeekly:50,xpMonthly:100,xpYearly:150,gold:50,friends:[]}),n=!0),!e.some((e=>"playerPL"===e.username))){e.push({username:"playerPL",email:"playerPL@example.com",country:"PL",password:"password",birthdate:"1995-01-01",avatarId:"avatar3",avatarName:"Zebra",xp:200,xpWeekly:70,xpMonthly:120,xpYearly:200,gold:70,friends:["testuser"]});const t=e.find((e=>"testuser"===e.username));t&&!t.friends.includes("playerPL")&&(t.friends.push("playerPL"),n=!0),n=!0}return e.some((e=>"AnotherUserMK"===e.username))||(e.push({username:"AnotherUserMK",email:"another@mk.com",country:"MK",password:"password123",birthdate:"1988-11-22",avatarId:"avatar4",avatarName:"King Of Water",xp:100,xpWeekly:30,xpMonthly:60,xpYearly:100,gold:30,friends:[]}),n=!0),n&&localStorage.setItem("PoKreGaM_users",JSON.stringify(e)),e}function saveUsers(e){localStorage.setItem("PoKreGaM_users",JSON.stringify(e))}function getCurrentUser(){const e=localStorage.getItem("PoKreGaM_currentUser");if(!e)return null;return getUsers().find((t=>t.username===e))||null}function setCurrentUser(e){e?localStorage.setItem("PoKreGaM_currentUser",e):localStorage.removeItem("PoKreGaM_currentUser")}function getPosts(){return JSON.parse(localStorage.getItem("PoKreGaM_posts")||"[]")}function savePosts(e){localStorage.setItem("PoKreGaM_posts",JSON.stringify(e))}function calculateLevel(e){return Math.floor(Math.sqrt(e/10))+1}function getKiritimatiDate(){const e=new Date,t=new Date(e.getTime()+6e4*e.getTimezoneOffset());return new Date(t.getTime()+504e5)}function getKiritimatiDateComponents(e){e instanceof Date||(e=new Date(e));const t=e.getUTCFullYear(),n=e.getUTCMonth(),a=e.getUTCDate(),r=(e.getUTCDay(),new Date(e)),o=r.getUTCDay(),s=0===o?6:o-1;return r.setUTCDate(r.getUTCDate()-s),r.setUTCHours(0,0,0,0),{year:t,month:n,day:a,startOfWeekISO:r.toISOString().split("T")[0]}}function handleRankingResets(){let e=JSON.parse(localStorage.getItem("PoKreGaM_lastResetDates")||"{}"),t=getUsers(),n=!1;const a=getKiritimatiDate(),r=getKiritimatiDateComponents(a),o=a.toISOString();e.weekly&&new Date(e.weekly).getTime()!==new Date(0).getTime()||(e.weekly=o,n=!0),e.monthly&&new Date(e.monthly).getTime()!==new Date(0).getTime()||(e.monthly=o,n=!0),e.yearly&&new Date(e.yearly).getTime()!==new Date(0).getTime()||(e.yearly=o,n=!0);getKiritimatiDateComponents(new Date(e.weekly)).startOfWeekISO!==r.startOfWeekISO&&(t.forEach((e=>e.xpWeekly=0)),e.weekly=o,n=!0,console.log("Weekly XP reset."));const s=getKiritimatiDateComponents(new Date(e.monthly));s.year===r.year&&s.month===r.month||(t.forEach((e=>e.xpMonthly=0)),e.monthly=o,n=!0,console.log("Monthly XP reset."));getKiritimatiDateComponents(new Date(e.yearly)).year!==r.year&&(t.forEach((e=>e.xpYearly=0)),e.yearly=o,n=!0,console.log("Yearly XP reset.")),void 0!==e.daily&&(delete e.daily,n=!0),n&&(saveUsers(t),localStorage.setItem("PoKreGaM_lastResetDates",JSON.stringify(e)))}function renderProfile(e){if(!e)return;$("profileAvatar").querySelector("img").src=avatars.find((t=>t.id===e.avatarId))?.src||"",$("profileAvatar").querySelector("img").alt=e.avatarName||"User avatar",$("profileUsername").textContent=sanitize(e.username),$("profileCountry").textContent=sanitize(e.country),$("profileXP").textContent=e.xp,$("profileFriendsCount").textContent=e.friends?.length||0,$("profileGold").textContent=e.gold,$("profileLevel").textContent=calculateLevel(e.xp);const t=getUsers().sort(((e,t)=>t.xp-e.xp)).findIndex((t=>t.username===e.username))+1;$("profileRankingPlace").textContent=t,"guest"===e.username?show($("checkThisBtn")):hide($("checkThisBtn"))}function renderRankingTable(e="overall"){const t=$("rankingTable").querySelector("tbody");let n=getUsers();const a=getCurrentUser();"global"===e&&a&&(n=n.filter((e=>e.country===a.country)));let r="xp";"weekly"===e?r="xpWeekly":"monthly"===e?r="xpMonthly":"yearly"===e&&(r="xpYearly"),n.sort(((e,t)=>t[r]-e[r])),t.innerHTML="",n.forEach(((e,n)=>{const o=document.createElement("tr"),s=a&&e.username!==a.username?`<button class="report-user-btn" data-username="${sanitize(e.username)}">${LANG[currentLang].reportUser}</button>`:"";o.innerHTML=`\n                <td>${n+1}</td>\n                <td>${sanitize(e.username)} ${s}</td>\n                <td>${e[r]}</td>\n                <td>${calculateLevel(e[r])}</td>\n            `,t.appendChild(o)}))}function renderPosts(){const e=$("communityPosts");e.innerHTML="";const t=getPosts().sort(((e,t)=>new Date(t.timestamp)-new Date(e.timestamp)));0!==t.length?t.forEach((t=>{const n=document.createElement("div");n.classList.add("post");const a=getUsers().find((e=>e.username===t.username)),r=a?avatars.find((e=>e.id===a.avatarId))?.src:"",o=a?a.avatarName:"Unknown";n.innerHTML=`\n                <div class="post-header">\n                    <div class="post-avatar">\n                        <img src="${r}" alt="${o}">\n                    </div>\n                    <div class="post-info">\n                        <div class="post-author">${sanitize(t.username)}</div>\n                        <div class="post-time">${new Date(t.timestamp).toLocaleString(currentLang)}</div>\n                    </div>\n                </div>\n                <div class="post-content">${sanitize(t.content)}</div>\n            `,e.appendChild(n)})):e.innerHTML=`<p style="text-align: center; color: #888;">${LANG[currentLang].noPostsYet}</p>`}function clearInputs(e){e.querySelectorAll("input").forEach((e=>e.value="")),e.querySelectorAll("select").forEach((e=>e.selectedIndex=0)),e.querySelectorAll("textarea").forEach((e=>e.value=""))}function showSection(e){["loginSection","signUpSection","profileSection","allChatsSection","forgotPasswordSection"].forEach((e=>{hide($(e))})),show(e)}function renderAllChats(){const e=$("chatsContent");e.innerHTML="",allChats.forEach((t=>{const n=document.createElement("div");n.classList.add("chat-container");let a="";"private"===t.type?a=`Private Chat (${t.participants.map((e=>sanitize(e))).join(" & ")})`:"game"===t.type&&(a=`Game Chat: ${sanitize(t.game)}`);const r=document.createElement("div");r.classList.add("chat-header"),r.textContent=a,n.appendChild(r),t.messages.forEach((e=>{const t=document.createElement("div");t.classList.add("chat-message"),t.innerHTML=`[${e.time}] <strong>${sanitize(e.sender)}:</strong> ${sanitize(e.text)}`,n.appendChild(t)})),e.appendChild(n)}))}function renderFriendsList(e){const t=$("myFriendsList");t.innerHTML="",e&&e.friends&&0!==e.friends.length?e.friends.forEach((e=>{const n=document.createElement("li");n.textContent=sanitize(e),t.appendChild(n)})):t.innerHTML=`<li>${LANG[currentLang].noFriendsYet}</li>`}function renderFriendSearchResults(e){const t=$("friendSearchResults");t.innerHTML="",0!==e.length?e.forEach((e=>{const n=getCurrentUser(),a=document.createElement("div");a.classList.add("user-card"),a.innerHTML=`\n                <span>${sanitize(e.username)}</span>\n                <button class="add-friend-btn" data-username="${sanitize(e.username)}">${LANG[currentLang].addFriend}</button>\n            `,(e.username===n.username||n.friends.includes(e.username))&&(a.querySelector(".add-friend-btn").disabled=!0,e.username===n.username?a.querySelector(".add-friend-btn").textContent=LANG[currentLang].cannotAddSelf:n.friends.includes(e.username)&&(a.querySelector(".add-friend-btn").textContent=LANG[currentLang].alreadyFriends)),t.appendChild(a)})):t.innerHTML=`<p>${LANG[currentLang].noSearchResults}</p>`}let selectedAvatarId=null;function init(){getUsers(),handleRankingResets(),renderAvatars(),$("avatarsContainer").addEventListener("click",(e=>{let t=e.target;for(;t&&!t.classList.contains("avatar");)t=t.parentElement;t&&(document.querySelectorAll(".avatar.selected").forEach((e=>e.classList.remove("selected"))),t.classList.add("selected"),selectedAvatarId=t.dataset.avatarId)})),$("avatarsContainer").addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.target.click())}));const e=getCurrentUser();e?(showSection($("profileSection")),renderProfile(e),renderRankingTable("overall"),n("gamesTab")):showSection($("loginSection"));const t=$("languageSelector");function n(e){$("tabs").querySelectorAll("button").forEach((e=>{"checkThisBtn"!==e.id&&"btnLogout"!==e.id&&(e.classList.remove("active"),e.setAttribute("aria-selected","false"))})),document.querySelectorAll(".tabContent").forEach((e=>hide(e)));const t=$(`${e}Button`);t&&(t.classList.add("active"),t.setAttribute("aria-selected","true"));const n=$(e);n&&(show(n),"rankingTab"===e?(handleRankingResets(),$("overallRankingBtn").click()):"postsTab"===e?renderPosts():"friendsTab"===e&&(renderFriendsList(getCurrentUser()),$("friendSearchResults").innerHTML="",$("friendSearchInput").value=""))}currentLang=t.value,translateUI(currentLang),t.addEventListener("change",(()=>{currentLang=t.value,translateUI(currentLang);const e=getCurrentUser();if(e){renderProfile(e);const t=$("rankingTypeButtons").querySelector(".active");t&&renderRankingTable(t.dataset.rankingType),renderPosts(),renderFriendsList(e)}})),$("tabs").addEventListener("click",(e=>{if("BUTTON"!==e.target.tagName)return;const t=e.target;if("checkThisBtn"===t.id){const e=getCurrentUser();return void(e&&"guest"===e.username&&(showSection($("allChatsSection")),renderAllChats()))}if("btnLogout"===t.id)return;$("tabs").querySelectorAll("button").forEach((e=>{e.classList.remove("active"),e.setAttribute("aria-selected","false")})),document.querySelectorAll(".tabContent").forEach((e=>hide(e))),t.classList.add("active"),t.setAttribute("aria-selected","true");const n=t.dataset.tab;n&&(show($(n)),"rankingTab"===n&&(handleRankingResets(),$("overallRankingBtn").click()),"postsTab"===n&&renderPosts(),"friendsTab"===n&&(renderFriendsList(getCurrentUser()),$("friendSearchResults").innerHTML="",$("friendSearchInput").value=""))})),$("navGames").addEventListener("click",(()=>{getCurrentUser()?(showSection($("profileSection")),n("gamesTab")):showSection($("loginSection"))})),$("navMarketplace").addEventListener("click",(()=>{getCurrentUser()?(showSection($("profileSection")),n("marketplaceTab")):showSection($("loginSection"))})),$("navBuild").addEventListener("click",(()=>{getCurrentUser()?(showSection($("profileSection")),n("buildTab")):showSection($("loginSection"))})),$("navNews").addEventListener("click",(()=>{getCurrentUser()?(showSection($("profileSection")),n("newsTab")):showSection($("loginSection"))})),$("navRanking").addEventListener("click",(()=>{getCurrentUser()?(showSection($("profileSection")),n("rankingTab")):showSection($("loginSection"))})),$("loginForm").addEventListener("submit",(e=>{e.preventDefault();const t=$("loginUsername").value.trim(),a=$("loginPassword").value.trim(),r=getUsers().find((e=>e.username===t&&e.password===a));r?(setCurrentUser(r.username),renderProfile(r),showSection($("profileSection")),clearInputs($("loginForm")),$("loginError").textContent="",n("gamesTab")):$("loginError").textContent=LANG[currentLang].loginError})),$("signUpForm").addEventListener("submit",(e=>{e.preventDefault();const t=$("signUpUsername").value.trim(),a=$("signUpEmail").value.trim(),r=$("signUpCountry").value,o=$("signUpPassword").value.trim(),s=$("signUpBirthdate").value;if(!(t&&o&&r&&s&&selectedAvatarId))return void($("signUpError").textContent=LANG[currentLang].signUpError);let i=getUsers();if(i.some((e=>e.username.toLowerCase()===t.toLowerCase())))return void($("signUpError").textContent=`Username "${t}" already exists.`);if(a&&i.some((e=>e.email===a)))return void($("signUpError").textContent=`Email "${a}" is already registered.`);const l=avatars.find((e=>e.id===selectedAvatarId)),d={username:t,password:o,email:a,country:r,birthdate:s,avatarId:l.id,avatarName:l.name,xp:0,xpWeekly:0,xpMonthly:0,xpYearly:0,gold:0,friends:[],lastWeeklyReset:getKiritimatiDate().toISOString(),lastMonthlyReset:getKiritimatiDate().toISOString(),lastYearlyReset:getKiritimatiDate().toISOString()};i.push(d),saveUsers(i),setCurrentUser(d.username),renderProfile(d),showSection($("profileSection")),clearInputs($("signUpForm")),$("signUpError").textContent="",document.querySelectorAll(".avatar.selected").forEach((e=>e.classList.remove("selected"))),selectedAvatarId=null,n("gamesTab")})),$("forgotPasswordForm").addEventListener("submit",(e=>{e.preventDefault();const t=$("forgotPasswordEmail").value.trim();const n=getUsers().find((e=>e.email===t));n?($("forgotPasswordMessage").textContent=LANG[currentLang].recoveryEmailSent.replace("{username}",sanitize(n.username)).replace("{password}",sanitize(n.password)),$("forgotPasswordError").textContent=""):($("forgotPasswordError").textContent=LANG[currentLang].recoveryEmailNotFound,$("forgotPasswordMessage").textContent="")})),$("btnLogout").addEventListener("click",(()=>{setCurrentUser(null),showSection($("loginSection")),clearInputs($("loginForm")),$("loginError").textContent=""})),$("toSignUp").addEventListener("click",(()=>{showSection($("signUpSection")),clearInputs($("loginForm")),$("loginError").textContent=""})),$("toLogin").addEventListener("click",(()=>{showSection($("loginSection")),clearInputs($("signUpForm")),$("signUpError").textContent="",document.querySelectorAll(".avatar.selected").forEach((e=>e.classList.remove("selected"))),selectedAvatarId=null})),$("forgotPasswordLink").addEventListener("click",(()=>{showSection($("forgotPasswordSection")),clearInputs($("loginForm")),$("loginError").textContent=""})),$("backToLoginFromForgot").addEventListener("click",(()=>{showSection($("loginSection")),clearInputs($("forgotPasswordForm")),$("forgotPasswordMessage").textContent="",$("forgotPasswordError").textContent=""})),$("rankingTypeButtons").addEventListener("click",(e=>{if("BUTTON"===e.target.tagName){$("rankingTypeButtons").querySelectorAll("button").forEach((e=>e.classList.remove("active"))),e.target.classList.add("active");renderRankingTable(e.target.dataset.rankingType)}})),$("startGameBtn").addEventListener("click",(()=>{let e=getCurrentUser();if(e){let t=getUsers(),n=t.findIndex((t=>t.username===e.username));if(-1!==n){const e=10;if(t[n].xp+=e,t[n].xpWeekly+=e,t[n].xpMonthly+=e,t[n].xpYearly+=e,t[n].gold+=1,saveUsers(t),setCurrentUser(t[n].username),renderProfile(t[n]),alert(`You gained ${e} XP and 1 Gold!`),$("rankingTab").classList.contains("active")){renderRankingTable($("rankingTypeButtons").querySelector(".active").dataset.rankingType)}}}})),$("publishPostBtn").addEventListener("click",(()=>{const e=$("postContent").value.trim();if(""===e)return $("postMessage").textContent=LANG[currentLang].postEmpty,$("postMessage").style.color="#dc3545",void setTimeout((()=>$("postMessage").textContent=""),3e3);const t=getCurrentUser();if(t){const n=getPosts(),a={username:t.username,content:e,timestamp:(new Date).toISOString()};n.push(a),savePosts(n),renderPosts(),$("postContent").value="",$("postMessage").textContent=LANG[currentLang].postPublished,$("postMessage").style.color="#28a745",setTimeout((()=>$("postMessage").textContent=""),3e3)}else $("postMessage").textContent="Please login to post.",$("postMessage").style.color="#dc3545",setTimeout((()=>$("postMessage").textContent=""),3e3)})),$("searchFriendBtn").addEventListener("click",(()=>{const e=$("friendSearchInput").value.trim().toLowerCase();if(e.length<2)return void renderFriendSearchResults([]);const t=getUsers(),n=getCurrentUser();renderFriendSearchResults(t.filter((t=>t.username.toLowerCase().includes(e)&&t.username!==n.username)))})),$("friendSearchResults").addEventListener("click",(e=>{if(e.target.classList.contains("add-friend-btn")){const t=e.target.dataset.username;let n=getUsers(),a=n.find((e=>e.username===getCurrentUser().username)),r=n.find((e=>e.username===t));if(a&&r&&!a.friends.includes(t)){a.friends.push(t),r.friends.includes(a.username)||r.friends.push(a.username),saveUsers(n),setCurrentUser(a.username),renderProfile(a),renderFriendsList(a);const e=$("friendSearchInput").value.trim().toLowerCase();renderFriendSearchResults(n.filter((t=>t.username.toLowerCase().includes(e)&&t.username!==a.username))),alert(LANG[currentLang].friendAdded.replace("{username}",sanitize(t)))}}}));const a=$("reportUserModal"),r=$("reportForm"),o=$("reportUsernameTarget"),s=$("reportMessage");let i=null;document.addEventListener("click",(e=>{if(e.target.classList.contains("report-user-btn")){i=e.target.dataset.username;const t=getCurrentUser();if(!t)return void alert(LANG[currentLang].loginError);if(i===t.username)return void alert(LANG[currentLang].reportCannotReportSelf);o.textContent=sanitize(i),s.textContent="",s.style.color="",r.reset(),show(a)}})),a.querySelector(".close-button").addEventListener("click",(()=>{hide(a)})),window.addEventListener("click",(e=>{e.target===a&&hide(a)})),r.addEventListener("submit",(e=>{e.preventDefault();const t=r.querySelector('input[name="reportReason"]:checked'),n=$("reportComment").value.trim();if(!t)return s.textContent=LANG[currentLang].reportNoReason,void(s.style.color="#dc3545");const o={reporter:getCurrentUser().username,reportedUser:i,reason:t.value,comment:n,timestamp:(new Date).toISOString()};console.log("User Report:",o),s.textContent=LANG[currentLang].reportSuccess,s.style.color="#28a745",r.reset(),i=null,setTimeout((()=>{hide(a),s.textContent="",s.style.color=""}),2e3)}))}document.addEventListener("DOMContentLoaded",init)</script>
</body>
</head></html>
